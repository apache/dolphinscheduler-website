<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="keywords" content="cluster-deployment">
  <meta name="description" content="cluster-deployment">
  <title>cluster-deployment</title>
  <link rel="shortcut icon" href="/img/favicon.ico">
  <link rel="stylesheet" href="/build/vendor.23870e5.css">
</head>
<body>
  <div id="root"><div class="md2html docs-page" data-reactroot=""><header class="header-container header-container-dark"><div class="header-body"><span class="mobile-menu-btn mobile-menu-btn-dark"></span><a href="/en-us/index.html"><img class="logo" src="/img/hlogo_white.svg"/></a><div class="search search-dark"><span class="icon-search"></span></div><span class="language-switch language-switch-dark">中</span><div class="header-menu"><div><ul class="ant-menu whiteClass ant-menu-light ant-menu-root ant-menu-horizontal" role="menu"><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/index.html" target="_self">HOME</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-item-selected" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span class="submenu-title-wrapper"><a href="/en-us/docs/latest/user_doc/guide/quick-start.html" target="_self">DOCS</a></span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/download/download.html" target="_self">DOWNLOAD</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/blog/index.html" target="_self">BLOG</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/development/development-environment-setup.html" target="_self">DEVELOPMENT</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/community/team.html" target="_self">COMMUNITY</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-submenu ant-menu-submenu-horizontal" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span class="submenu-title-wrapper"><a href="https://www.apache.org/" target="_blank">ASF</a></span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/user/index.html" target="_self">USER</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul></div></div><div class="mobile-menu"><div class="mobile-menu-content"><div class="mobile-menu-list"><div class="mobile-menu-item"><a class="mobile-menu-title" href="/en-us/index.html" target="_self">HOME</a></div><div class="mobile-menu-item"><a class="mobile-menu-title" href="/en-us/docs/latest/user_doc/guide/quick-start.html" target="_self">DOCS</a><em class="mobile-menu-icon"></em><div class="mobile-sub-menus"><div class="mobile-sub-menu-item"><a href="/en-us/docs/latest/user_doc/guide/quick-start.html" target="_self">latest(2.0.5)</a></div><div class="mobile-sub-menu-item"><a href="/en-us/docs/1.3.9/user_doc/quick-start.html" target="_self">1.3.9</a></div><div class="mobile-sub-menu-item"><a href="/en-us/docs/release/history-versions.html" target="_self">Older Versions</a></div><div class="mobile-sub-menu-item"><a href="/python/index.html" target="_self">PyDolphinScheduler</a></div><div class="mobile-sub-menu-item"><a href="/en-us/docs/dev/user_doc/about/introduction.html" target="_self">dev</a></div></div></div><div class="mobile-menu-item"><a class="mobile-menu-title" href="/en-us/download/download.html" target="_self">DOWNLOAD</a></div><div class="mobile-menu-item"><a class="mobile-menu-title" href="/en-us/blog/index.html" target="_self">BLOG</a></div><div class="mobile-menu-item"><a class="mobile-menu-title" href="/en-us/development/development-environment-setup.html" target="_self">DEVELOPMENT</a></div><div class="mobile-menu-item"><a class="mobile-menu-title" href="/en-us/community/team.html" target="_self">COMMUNITY</a></div><div class="mobile-menu-item"><a class="mobile-menu-title" href="https://www.apache.org/" target="_blank">ASF</a><em class="mobile-menu-icon"></em><div class="mobile-sub-menus"><div class="mobile-sub-menu-item"><a href="https://www.apache.org/" target="_blank">Foundation</a></div><div class="mobile-sub-menu-item"><a href="https://www.apache.org/licenses/" target="_blank">License</a></div><div class="mobile-sub-menu-item"><a href="https://www.apache.org/events/current-event" target="_blank">Events</a></div><div class="mobile-sub-menu-item"><a href="https://www.apache.org/security/" target="_blank">Security</a></div><div class="mobile-sub-menu-item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank">Sponsorship</a></div><div class="mobile-sub-menu-item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank">Thanks</a></div></div></div><div class="mobile-menu-item"><a class="mobile-menu-title" href="/en-us/user/index.html" target="_self">USER</a></div></div></div><div class="mobile-menu-dummy"></div></div></div></header><section class="content-section"><div class="sidemenu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span>Deployment Document</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.3.1/user_doc/hardware-environment.html" target="_self">Hardware Environment</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.3.1/user_doc/standalone-deployment.html" target="_self">Standalone Deployment</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.3.1/user_doc/cluster-deployment.html" target="_self">Cluster deploy</a></li></ul></li><li class="menu-item menu-item-level-1"><span>User Manual</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.3.1/user_doc/quick-start.html" target="_self">Quick Start</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.3.1/user_doc/system-manual.html" target="_self">User Manual</a></li></ul></li><li class="menu-item menu-item-level-1"><span>Architecture Design</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.3.1/user_doc/metadata-1.3.html" target="_self">Metadata</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.3.1/user_doc/architecture-design.html" target="_self">Architecture Design</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.3.1/user_doc/configuration-file.html" target="_self">Configuration File</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.3.1/user_doc/task-structure.html" target="_self">Task Structure</a></li></ul></li><li class="menu-item menu-item-level-1"><span>Upgrade</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.3.1/user_doc/upgrade.html" target="_self">Upgrade</a></li></ul></li><li class="menu-item menu-item-level-1"><span>FAQ</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/release/faq.html" target="_self">FAQ</a></li></ul></li></ul></div><div class="doc-content markdown-body"><h1>Cluster Deployment</h1>
<h1>1、Before you begin (please install requirement basic software by yourself)</h1>
<ul>
<li><a href="https://www.postgresql.org/download/">PostgreSQL</a> (8.2.15+) or <a href="https://dev.mysql.com/downloads/mysql/">MySQL</a> (5.7) : Choose One</li>
<li><a href="https://www.oracle.com/technetwork/java/javase/downloads/index.html">JDK</a> (1.8+) : Required. Double-check configure JAVA_HOME and PATH environment variables in /etc/profile</li>
<li><a href="https://zookeeper.apache.org/releases.html">ZooKeeper</a> (3.4.6+) : Required</li>
<li>pstree or psmisc : &quot;pstree&quot; is required for Mac OS and &quot;psmisc&quot; is required for Fedora/Red/Hat/CentOS/Ubuntu/Debian</li>
<li><a href="https://hadoop.apache.org/releases.html">Hadoop</a> (2.6+) or <a href="https://min.io/download">MinIO</a> : Optional. If you need to upload a resource function, you can choose a local file directory as the upload folder for a single machine (this operation does not need to deploy Hadoop). Of course, you can also choose to upload to Hadoop or MinIO.</li>
</ul>
<pre><code class="language-markdown"> Tips: DolphinScheduler itself does not rely on Hadoop, Hive, Spark, only use their clients for the corresponding task of running.
</code></pre>
<h1>2、Download the binary package.</h1>
<ul>
<li>Please download the latest version of the default installation package to the server deployment directory. For example, use /opt/dolphinscheduler as the installation and deployment directory. Download address: <a href="/en-us/download/download.html">download</a>，Download the package and move to the installation and deployment directory. Then uncompress it.</li>
</ul>
<pre><code class="language-shell"><span class="hljs-meta">#</span><span class="bash"> Create the deployment directory. Do not choose a deployment directory with a high-privilege directory such as / root or / home.</span>
mkdir -p /opt/dolphinscheduler;
cd /opt/dolphinscheduler;
<span class="hljs-meta">#</span><span class="bash"> uncompress</span>
tar -zxvf apache-dolphinscheduler-incubating-1.3.1-dolphinscheduler-bin.tar.gz -C /opt/dolphinscheduler;

mv apache-dolphinscheduler-incubating-1.3.1-dolphinscheduler-bin  dolphinscheduler-bin
</code></pre>
<h1>3、Create deployment user and hosts mapping</h1>
<ul>
<li>Create a deployment user on the ** all ** deployment machines, and be sure to configure sudo passwordless. If we plan to deploy DolphinScheduler on 4 machines: ds1, ds2, ds3, and ds4, we first need to create a deployment user on each machine.</li>
</ul>
<pre><code class="language-shell"><span class="hljs-meta">#</span><span class="bash"> To create a user, you need to <span class="hljs-built_in">log</span> <span class="hljs-keyword">in</span> as root and <span class="hljs-built_in">set</span> the deployment user name. Please modify it yourself. The following uses dolphinscheduler as an example.</span>
useradd dolphinscheduler;
<span class="hljs-meta">
#</span><span class="bash"> Set the user password, please modify it yourself. The following takes dolphinscheduler123 as an example.</span>
echo &quot;dolphinscheduler123&quot; | passwd --stdin dolphinscheduler
<span class="hljs-meta">
#</span><span class="bash"> Configure sudo passwordless</span>
echo &#x27;dolphinscheduler  ALL=(ALL)  NOPASSWD: NOPASSWD: ALL&#x27; &gt;&gt; /etc/sudoers
sed -i &#x27;s/Defaults    requirett/#Defaults    requirett/g&#x27; /etc/sudoers

</code></pre>
<pre><code> Notes：
 - Because the task execution service is based on 'sudo -u {linux-user}' to switch between different Linux users to implement multi-tenant running jobs, the deployment user needs to have sudo permissions and is passwordless. The first-time learners who can ignore it if they don't understand.
 - If find the &quot;Default requiretty&quot; in the &quot;/etc/sudoers&quot; file, also comment out.
 - If you need to use resource upload, you need to assign the user of permission to operate the local file system, HDFS or MinIO.
</code></pre>
<h1>4、Configure hosts mapping and ssh access and modify directory permissions.</h1>
<ul>
<li>
<p>Use the first machine (hostname is ds1) as the deployment machine, configure the hosts of all machines to be deployed on ds1, and login as root on ds1.</p>
<pre><code class="language-shell">vi /etc/hosts
<span class="hljs-meta">
#</span><span class="bash">add ip hostname</span>
192.168.xxx.xxx ds1
192.168.xxx.xxx ds2
192.168.xxx.xxx ds3
192.168.xxx.xxx ds4
</code></pre>
<p><em>Note: Please delete or comment out the line 127.0.0.1</em></p>
</li>
<li>
<p>Sync /etc/hosts on ds1 to all deployment machines</p>
<pre><code class="language-shell">for ip in ds2 ds3;     # Please replace ds2 ds3 here with the hostname of machines you want to deploy
do
    sudo scp -r /etc/hosts  $ip:/etc/          # Need to enter root password during operation
done
</code></pre>
<p><em>Note: can use <code>sshpass -p xxx sudo scp -r /etc/hosts $ip:/etc/</code> to avoid type password.</em></p>
<blockquote>
<p>Install sshpass in Centos：</p>
<ol>
<li>
<p>Install epel</p>
<p>yum install -y epel-release</p>
<p>yum repolist</p>
</li>
<li>
<p>After installing epel, you can install sshpass</p>
<p>yum install -y sshpass</p>
</li>
</ol>
</blockquote>
</li>
<li>
<p>On ds1, switch to the deployment user and configure ssh passwordless login</p>
<pre><code class="language-shell"> su dolphinscheduler;

ssh-keygen -t rsa -P &#x27;&#x27; -f ~/.ssh/id_rsa
cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys
chmod 600 ~/.ssh/authorized_keys
</code></pre>
</li>
</ul>
<p>​      Note: <em>If configure success, the dolphinscheduler user does not need to enter a password when executing the command <code>ssh localhost</code></em></p>
<ul>
<li>
<p>On ds1, configure the deployment user dolphinscheduler ssh to connect to other machines to be deployed.</p>
<pre><code class="language-shell">su dolphinscheduler;
for ip in ds2 ds3;     # Please replace ds2 ds3 here with the hostname of the machine you want to deploy.
do
    ssh-copy-id  $ip   # You need to manually enter the password of the dolphinscheduler user during the operation.
done
<span class="hljs-meta">#</span><span class="bash"> can use `sshpass -p xxx ssh-copy-id <span class="hljs-variable">$ip</span>` to avoid <span class="hljs-built_in">type</span> password.</span>
</code></pre>
</li>
<li>
<p>On ds1, modify the directory permissions so that the deployment user has operation permissions on the dolphinscheduler-bin directory.</p>
<pre><code class="language-shell">sudo chown -R dolphinscheduler:dolphinscheduler dolphinscheduler-bin
</code></pre>
</li>
</ul>
<h1>5、Database initialization</h1>
<ul>
<li>Into the database. The default database is PostgreSQL. If you select MySQL, you need to add the mysql-connector-java driver package to the lib directory of DolphinScheduler.</li>
</ul>
<pre><code>mysql -h192.168.xx.xx -P3306 -uroot -p
</code></pre>
<ul>
<li>After entering the database command line window, execute the database initialization command and set the user and password. <strong>Note: {user} and {password} need to be replaced with a specific database username and password</strong></li>
</ul>
<pre><code class="language-mysql">   mysql&gt; CREATE DATABASE dolphinscheduler DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;
   mysql&gt; GRANT ALL PRIVILEGES ON dolphinscheduler.* TO &#x27;{user}&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;{password}&#x27;;
   mysql&gt; GRANT ALL PRIVILEGES ON dolphinscheduler.* TO &#x27;{user}&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;{password}&#x27;;
   mysql&gt; flush privileges;
</code></pre>
<ul>
<li>
<p>Create tables and import basic data</p>
<ul>
<li>Modify the following configuration in datasource.properties under the conf directory</li>
</ul>
<pre><code class="language-shell">  vi conf/datasource.properties
</code></pre>
<ul>
<li>If you choose Mysql, please comment out the relevant configuration of PostgreSQL (vice versa), you also need to manually add the [[mysql-connector-java driver jar] (<a href="https://downloads.mysql.com/archives/c-j/">https://downloads.mysql.com/archives/c-j/</a>) package to lib under the directory, and then configure the database connection information correctly.</li>
</ul>
<pre><code class="language-properties"><span class="hljs-comment">  #postgre</span>
<span class="hljs-comment">  #spring.datasource.driver-class-name=org.postgresql.Driver</span>
<span class="hljs-comment">  #spring.datasource.url=jdbc:postgresql://localhost:5432/dolphinscheduler</span>
<span class="hljs-comment">  # mysql</span>
  <span class="hljs-meta">spring.datasource.driver-class-name</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span>
  <span class="hljs-meta">spring.datasource.url</span>=<span class="hljs-string">jdbc:mysql://xxx:3306/dolphinscheduler?useUnicode=true&amp;characterEncoding=UTF-8&amp;allowMultiQueries=true     # Replace the correct IP address</span>
  <span class="hljs-meta">spring.datasource.username</span>=<span class="hljs-string">xxx						# replace the correct {user} value</span>
  <span class="hljs-meta">spring.datasource.password</span>=<span class="hljs-string">xxx						# replace the correct {password} value</span>
</code></pre>
<ul>
<li>After modifying and saving, execute the create table and import data script in the script directory.</li>
</ul>
<pre><code class="language-shell">sh script/create-dolphinscheduler.sh
</code></pre>
</li>
</ul>
<p>​       <em>Note: If you execute the above script and report &quot;/bin/java: No such file or directory&quot; error, please configure JAVA_HOME and PATH variables in /etc/profile</em></p>
<h1>6、Modify runtime parameters.</h1>
<ul>
<li>
<p>Modify the environment variable in <code>dolphinscheduler_env.sh</code> file which on the 'conf/env' directory (take the relevant software installed under '/opt/soft' as an example)</p>
<pre><code class="language-shell">    export HADOOP_HOME=/opt/soft/hadoop
    export HADOOP_CONF_DIR=/opt/soft/hadoop/etc/hadoop
    #export SPARK_HOME1=/opt/soft/spark1
    export SPARK_HOME2=/opt/soft/spark2
    export PYTHON_HOME=/opt/soft/python
    export JAVA_HOME=/opt/soft/java
    export HIVE_HOME=/opt/soft/hive
    export FLINK_HOME=/opt/soft/flink
    export DATAX_HOME=/opt/soft/datax/bin/datax.py
    export PATH=$HADOOP_HOME/bin:$SPARK_HOME2/bin:$PYTHON_HOME:$JAVA_HOME/bin:$HIVE_HOME/bin:$PATH:$FLINK_HOME/bin:$DATAX_HOME:$PATH

    ```

 `Note: This step is very important. For example, JAVA_HOME and PATH must be configured. Those that are not used can be ignored or commented out.`



</code></pre>
</li>
<li>
<p>Create Soft link jdk to /usr/bin/java (still JAVA_HOME=/opt/soft/java as an example)</p>
<pre><code class="language-shell">sudo ln -s /opt/soft/java/bin/java /usr/bin/java
</code></pre>
</li>
<li>
<p>Modify the parameters in the one-click deployment config file <code>conf/config/install_config.conf</code>, pay special attention to the configuration of the following parameters.</p>
<pre><code class="language-shell"><span class="hljs-meta">#</span><span class="bash"> choose mysql or postgresql</span>
dbtype=&quot;mysql&quot;
<span class="hljs-meta">
#</span><span class="bash"> Database connection address and port</span>
dbhost=&quot;192.168.xx.xx:3306&quot;
<span class="hljs-meta">
#</span><span class="bash"> database name</span>
dbname=&quot;dolphinscheduler&quot;
<span class="hljs-meta">
#</span><span class="bash"> database username</span>
username=&quot;xxx&quot;
<span class="hljs-meta">
#</span><span class="bash"> database password</span>
<span class="hljs-meta">#</span><span class="bash"> NOTICE: <span class="hljs-keyword">if</span> there are special characters, please use the \ to escape, <span class="hljs-keyword">for</span> example, `[` escape to `\[`</span>
password=&quot;xxx&quot;
<span class="hljs-meta">
#</span><span class="bash">Zookeeper cluster</span>
zkQuorum=&quot;192.168.xx.xx:2181,192.168.xx.xx:2181,192.168.xx.xx:2181&quot;
<span class="hljs-meta">
#</span><span class="bash"> Note: the target installation path <span class="hljs-keyword">for</span> dolphinscheduler, please not config as the same as the current path (<span class="hljs-built_in">pwd</span>)</span>
installPath=&quot;/opt/soft/dolphinscheduler&quot;
<span class="hljs-meta">
#</span><span class="bash"> deployment user</span>
<span class="hljs-meta">#</span><span class="bash"> Note: the deployment user needs to have sudo privileges and permissions to operate hdfs. If hdfs is enabled, the root directory needs to be created by itself</span>
deployUser=&quot;dolphinscheduler&quot;
<span class="hljs-meta">
#</span><span class="bash"> alert config，take QQ email <span class="hljs-keyword">for</span> example</span>
<span class="hljs-meta">#</span><span class="bash"> mail protocol</span>
mailProtocol=&quot;SMTP&quot;
<span class="hljs-meta">
#</span><span class="bash"> mail server host</span>
mailServerHost=&quot;smtp.qq.com&quot;
<span class="hljs-meta">
#</span><span class="bash"> mail server port</span>
<span class="hljs-meta">#</span><span class="bash"> note: Different protocols and encryption methods correspond to different ports, when SSL/TLS is enabled, make sure the port is correct.</span>
mailServerPort=&quot;25&quot;
<span class="hljs-meta">
#</span><span class="bash"> mail sender</span>
mailSender=&quot;xxx@qq.com&quot;
<span class="hljs-meta">
#</span><span class="bash"> mail user</span>
mailUser=&quot;xxx@qq.com&quot;
<span class="hljs-meta">
#</span><span class="bash"> mail sender password</span>
<span class="hljs-meta">#</span><span class="bash"> note: The mail.passwd is email service authorization code, not the email login password.</span>
mailPassword=&quot;xxx&quot;
<span class="hljs-meta">
#</span><span class="bash"> Whether TLS mail protocol is supported,<span class="hljs-literal">true</span> is supported and <span class="hljs-literal">false</span> is not supported</span>
starttlsEnable=&quot;true&quot;
<span class="hljs-meta">
#</span><span class="bash"> Whether TLS mail protocol is supported,<span class="hljs-literal">true</span> is supported and <span class="hljs-literal">false</span> is not supported。</span>
<span class="hljs-meta">#</span><span class="bash"> note: only one of TLS and SSL can be <span class="hljs-keyword">in</span> the <span class="hljs-literal">true</span> state.</span>
sslEnable=&quot;false&quot;
<span class="hljs-meta">
#</span><span class="bash"> note: sslTrust is the same as mailServerHost</span>
sslTrust=&quot;smtp.qq.com&quot;
<span class="hljs-meta">

#</span><span class="bash"> resource storage <span class="hljs-built_in">type</span>：HDFS,S3,NONE</span>
resourceStorageType=&quot;HDFS&quot;
<span class="hljs-meta">
#</span><span class="bash"> If resourceStorageType = HDFS, and your Hadoop Cluster NameNode has HA enabled, you need to put core-site.xml and hdfs-site.xml <span class="hljs-keyword">in</span> the installPath/conf directory. In this example, it is placed under /opt/soft/dolphinscheduler/conf, and configure the namenode cluster name; <span class="hljs-keyword">if</span> the NameNode is not HA, modify it to a specific IP or host name.</span>
<span class="hljs-meta">#</span><span class="bash"> <span class="hljs-keyword">if</span> S3，write S3 address，HA，<span class="hljs-keyword">for</span> example ：s3a://dolphinscheduler，</span>
<span class="hljs-meta">#</span><span class="bash"> Note，s3 be sure to create the root directory /dolphinscheduler</span>
defaultFS=&quot;hdfs://mycluster:8020&quot;
<span class="hljs-meta">

#</span><span class="bash"> <span class="hljs-keyword">if</span> not use hadoop resourcemanager, please keep default value; <span class="hljs-keyword">if</span> resourcemanager HA <span class="hljs-built_in">enable</span>, please <span class="hljs-built_in">type</span> the HA ips ; <span class="hljs-keyword">if</span> resourcemanager is single, make this value empty</span>
yarnHaIps=&quot;192.168.xx.xx,192.168.xx.xx&quot;
<span class="hljs-meta">
#</span><span class="bash"> <span class="hljs-keyword">if</span> resourcemanager HA <span class="hljs-built_in">enable</span> or not use resourcemanager, please skip this value setting; If resourcemanager is single, you only need to replace yarnIp1 to actual resourcemanager hostname.</span>
singleYarnIp=&quot;yarnIp1&quot;
<span class="hljs-meta">
#</span><span class="bash"> resource store on HDFS/S3 path, resource file will store to this hadoop hdfs path, self configuration, please make sure the directory exists on hdfs and have <span class="hljs-built_in">read</span> write permissions。/dolphinscheduler is recommended</span>
resourceUploadPath=&quot;/dolphinscheduler&quot;
<span class="hljs-meta">
#</span><span class="bash"> who have permissions to create directory under HDFS/S3 root path</span>
<span class="hljs-meta">#</span><span class="bash"> Note: <span class="hljs-keyword">if</span> kerberos is enabled, please config hdfsRootUser=</span>
hdfsRootUser=&quot;hdfs&quot;
<span class="hljs-meta">


#</span><span class="bash"> install hosts</span>
<span class="hljs-meta">#</span><span class="bash"> Note: install the scheduled hostname list. If it is pseudo-distributed, just write a pseudo-distributed hostname</span>
ips=&quot;ds1,ds2,ds3,ds4&quot;
<span class="hljs-meta">
#</span><span class="bash"> ssh port, default 22</span>
<span class="hljs-meta">#</span><span class="bash"> Note: <span class="hljs-keyword">if</span> ssh port is not default, modify here</span>
sshPort=&quot;22&quot;
<span class="hljs-meta">
#</span><span class="bash"> run master machine</span>
<span class="hljs-meta">#</span><span class="bash"> Note: list of hosts hostname <span class="hljs-keyword">for</span> deploying master</span>
masters=&quot;ds1,ds2&quot;
<span class="hljs-meta">
#</span><span class="bash"> run worker machine</span>
<span class="hljs-meta">#</span><span class="bash"> note: need to write the worker group name of each worker, the default value is <span class="hljs-string">&quot;default&quot;</span></span>
workers=&quot;ds3:default,ds4:default&quot;
<span class="hljs-meta">
#</span><span class="bash"> run alert machine</span>
<span class="hljs-meta">#</span><span class="bash"> note: list of machine hostnames <span class="hljs-keyword">for</span> deploying alert server</span>
alertServer=&quot;ds2&quot;
<span class="hljs-meta">
#</span><span class="bash"> run api machine</span>
<span class="hljs-meta">#</span><span class="bash"> note: list of machine hostnames <span class="hljs-keyword">for</span> deploying api server</span>
apiServers=&quot;ds1&quot;

</code></pre>
<p><em>Attention:</em></p>
<ul>
<li>If you need to upload resources to the Hadoop cluster, and the NameNode of the Hadoop cluster is configured with HA, you need to enable HDFS resource upload, and you need to copy the core-site.xml and hdfs-site.xml in the Hadoop cluster to /opt/ dolphinscheduler/conf. Non-NameNode HA skips the next step.</li>
</ul>
</li>
</ul>
<h1>7、Automated Deployment</h1>
<ul>
<li>
<p>Switch to the deployment user and execute the one-click deployment script</p>
<p><code>sh install.sh</code></p>
<pre><code>Note:
For the first deployment, the following message appears in step 3 of `3, stop server` during operation. This message can be ignored.
sh: bin/dolphinscheduler-daemon.sh: No such file or directory
</code></pre>
</li>
<li>
<p>After the script is completed, the following 5 services will be started. Use the <code>jps</code> command to check whether the services are started (<code>jps</code> comes with <code>java JDK</code>)</p>
</li>
</ul>
<pre><code class="language-aidl">    MasterServer         ----- master service
    WorkerServer         ----- worker service
    LoggerServer         ----- logger service
    ApiApplicationServer ----- api service
    AlertServer          ----- alert service
</code></pre>
<p>If the above services are started normally, the automatic deployment is successful.</p>
<p>After the deployment is successful, you can view the logs. The logs are stored in the logs folder.</p>
<pre><code class="language-log"> logs/
    ├── dolphinscheduler-alert-server.log
    ├── dolphinscheduler-master-server.log
    |—— dolphinscheduler-worker-server.log
    |—— dolphinscheduler-api-server.log
    |—— dolphinscheduler-logger-server.log
</code></pre>
<h1>8、login</h1>
<ul>
<li>
<p>Access the address of the front page, interface IP (self-modified)
<a href="http://localhost:12345/dolphinscheduler">http://localhost:12345/dolphinscheduler</a></p>
 <p align="center">
   <img src="/img/login.png" width="60%" />
 </p>
</li>
</ul>
<h1>9、Start and stop service</h1>
<ul>
<li>
<p>Stop all services</p>
<p><code>sh ./bin/stop-all.sh</code></p>
</li>
<li>
<p>Start all services</p>
<p><code>sh ./bin/start-all.sh</code></p>
</li>
<li>
<p>Start and stop master service</p>
</li>
</ul>
<pre><code class="language-shell">sh ./bin/dolphinscheduler-daemon.sh start master-server
sh ./bin/dolphinscheduler-daemon.sh stop master-server
</code></pre>
<ul>
<li>Start and stop worker Service</li>
</ul>
<pre><code class="language-shell">sh ./bin/dolphinscheduler-daemon.sh start worker-server
sh ./bin/dolphinscheduler-daemon.sh stop worker-server
</code></pre>
<ul>
<li>Start and stop api Service</li>
</ul>
<pre><code class="language-shell">sh ./bin/dolphinscheduler-daemon.sh start api-server
sh ./bin/dolphinscheduler-daemon.sh stop api-server
</code></pre>
<ul>
<li>Start and stop logger Service</li>
</ul>
<pre><code class="language-shell">sh ./bin/dolphinscheduler-daemon.sh start logger-server
sh ./bin/dolphinscheduler-daemon.sh stop logger-server
</code></pre>
<ul>
<li>Start and stop alert service</li>
</ul>
<pre><code class="language-shell">sh ./bin/dolphinscheduler-daemon.sh start alert-server
sh ./bin/dolphinscheduler-daemon.sh stop alert-server
</code></pre>
<p><code>Note: Please refer to the &quot;Architecture Design&quot; section for service usage</code></p>
</div></section><footer class="footer-container"><div class="footer-body"><div><h3>About us</h3><h4>Do you need feedback? Please contact us through the following ways.</h4></div><div class="contact-container"><ul><li><a href="/en-us/community/development/subscribe.html"><img class="img-base" src="/img/emailgray.png"/><img class="img-change" src="/img/emailblue.png"/><p>Email List</p></a></li><li><a href="https://twitter.com/dolphinschedule"><img class="img-base" src="/img/twittergray.png"/><img class="img-change" src="/img/twitterblue.png"/><p>Twitter</p></a></li><li><a href="https://stackoverflow.com/questions/tagged/apache-dolphinscheduler"><img class="img-base" src="/img/stackoverflow.png"/><img class="img-change" src="/img/stackoverflow-selected.png"/><p>Stack Overflow</p></a></li><li><a href="https://join.slack.com/t/asf-dolphinscheduler/shared_invite/zt-omtdhuio-_JISsxYhiVsltmC5h38yfw"><img class="img-base" src="/img/slack.png"/><img class="img-change" src="/img/slack-selected.png"/><p>Slack</p></a></li></ul></div><div class="cols-container"><div class="docu-container"><h4>Documentation</h4><ul><li><a href="/en-us/development/architecture-design.html"><p>Overview</p></a></li><li><a href="/en-us/docs/latest/user_doc/guide/quick-start.html"><p>Quick start</p></a></li><li><a href="/en-us/development/development-environment-setup.html"><p>Developer guide</p></a></li></ul></div><div></div><div class="asf-container"><h4>ASF</h4><ul><li><a href="http://www.apache.org"><p>Foundation</p></a></li><li><a href="http://www.apache.org/licenses/"><p>License</p></a></li><li><a href="http://www.apache.org/events/current-event"><p>Events</p></a></li><li><a href="http://www.apache.org/foundation/sponsorship.html"><p>Sponsorship</p></a></li><li><a href="http://www.apache.org/foundation/thanks.html"><p>Thanks</p></a></li></ul></div></div><div class="copyright"><span>Copyright © 2019-2021 The Apache Software Foundation. Apache DolphinScheduler, DolphinScheduler, and its feather logo are trademarks of The Apache Software Foundation.</span></div></div></footer></div></div>
  <script src="//cdn.jsdelivr.net/npm/react@15.6.2/dist/react-with-addons.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/react-dom@15.6.2/dist/react-dom.min.js"></script>
  <script>window.rootPath = '';</script>
  <script src="/build/vendor.90dcf97.js"></script>
  <script src="/build/docs.md.8182f21.js"></script>
  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?4e7b4b400dd31fa015018a435c64d06f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-899J8PYKJZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-899J8PYKJZ');
  </script>
</body>
</html>