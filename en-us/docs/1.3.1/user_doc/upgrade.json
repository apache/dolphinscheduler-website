{
  "filename": "upgrade.md",
  "__html": "<h1>DolphinScheduler Upgrade document</h1>\n<h2>1. Back up files and databases of the previous version</h2>\n<h2>2. Stop all services of dolphinscheduler</h2>\n<p><code>sh ./script/stop-all.sh</code></p>\n<h2>3. Download the new version of the installation package</h2>\n<ul>\n<li><a href=\"/en-us/download/download.html\">download</a>, Download the latest version of the binary installation package</li>\n<li>The following upgrade operations need to be performed in the new version directory</li>\n</ul>\n<h2>4. Database upgrade</h2>\n<ul>\n<li>\n<p>Modify the following properties in conf/datasource.properties</p>\n</li>\n<li>\n<p>If you choose MySQL, please comment out the PostgreSQL related configuration (the same is true for the reverse), and you also need to manually add the [<a href=\"https://downloads.MySQL.com/archives/\"> mysql-connector-java driver jar</a> package to lib In the directory, here is mysql-connector-java-5.1.47.jar, and then correctly configure the database connection related information</p>\n<pre><code class=\"language-properties\"><span class=\"hljs-comment\">  # postgre</span>\n<span class=\"hljs-comment\">  #spring.datasource.driver-class-name=org.postgresql.Driver</span>\n<span class=\"hljs-comment\">  #spring.datasource.url=jdbc:postgresql://localhost:5432/dolphinscheduler</span>\n<span class=\"hljs-comment\">  # mysql</span>\n  <span class=\"hljs-meta\">spring.datasource.driver-class-name</span>=<span class=\"hljs-string\">com.mysql.jdbc.Driver</span>\n  <span class=\"hljs-meta\">spring.datasource.url</span>=<span class=\"hljs-string\">jdbc:mysql://xxx:3306/dolphinscheduler?useUnicode=true&amp;characterEncoding=UTF-8&amp;allowMultiQueries=true     Need to modify the ip, the local localhost can</span>\n  <span class=\"hljs-meta\">spring.datasource.username</span>=<span class=\"hljs-string\">xxx\t\t\t\t\t\tNeed to be modified to the above {user} value</span>\n  <span class=\"hljs-meta\">spring.datasource.password</span>=<span class=\"hljs-string\">xxx\t\t\t\t\t\tNeed to be modified to the above {password} value</span>\n</code></pre>\n</li>\n<li>\n<p>Execute database upgrade script</p>\n</li>\n</ul>\n<p><code>sh ./script/upgrade-dolphinscheduler.sh</code></p>\n<h2>5. Service upgrade</h2>\n<h3>5.1 Modify <code>conf/config/install_config.conf</code> configuration content</h3>\n<p>For standalone deployment, please refer to <a href=\"./standalone-deployment.md\">Standalone deployment</a> in <code>6. Modify the running parameters section</code>\nFor cluster deployment, please refer to <a href=\"./cluster-deployment.md\">Cluster Deployment (Cluster)</a> in <code>6. Modify the operating parameters section</code></p>\n<h3>Precautions</h3>\n<p>Creating worker groups has a different design in version 1.3.1 and previous versions</p>\n<ul>\n<li>The worker group was created through the UI interface before version 1.3.1</li>\n<li>Worker grouping in version 1.3.1 is to modify the worker configuration designation</li>\n</ul>\n<h3>How to set the worker grouping during the upgrade is the same as before</h3>\n<p>1、Query the database that has been backed up, check the t_ds_worker_group table records, and focus on the three fields id, name and ip_list</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">id</th>\n<th style=\"text-align:center\">name</th>\n<th style=\"text-align:right\">ip_list</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">1</td>\n<td style=\"text-align:center\">service1</td>\n<td style=\"text-align:right\">192.168.xx.10</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">2</td>\n<td style=\"text-align:center\">service2</td>\n<td style=\"text-align:right\">192.168.xx.11,192.168.xx.12</td>\n</tr>\n</tbody>\n</table>\n<p>2、Modify the workers parameter in conf/config/install_config.conf</p>\n<p>Assume that the following is the correspondence between the host name and ip of the worker to be deployed</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">CPU name</th>\n<th style=\"text-align:center\">ip</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">ds1</td>\n<td style=\"text-align:center\">192.168.xx.10</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ds2</td>\n<td style=\"text-align:center\">192.168.xx.11</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ds3</td>\n<td style=\"text-align:center\">192.168.xx.12</td>\n</tr>\n</tbody>\n</table>\n<p>In order to keep the grouping consistent with the previous version of the worker, you need to change the workers parameter to the following</p>\n<pre><code class=\"language-shell\"><span class=\"hljs-meta\">#</span><span class=\"bash\">workerService is deployed on <span class=\"hljs-built_in\">which</span> machine, and specify <span class=\"hljs-built_in\">which</span> worker group this worker belongs to</span>\nworkers=&quot;ds1:service1,ds2:service2,ds3:service2&quot;\n</code></pre>\n<h3>5.2 Execute deployment script</h3>\n<pre><code class=\"language-shell\">`sh install.sh`\n</code></pre>\n",
  "link": "/dist/en-us/docs/1.3.1/user_doc/upgrade.html",
  "meta": {}
}