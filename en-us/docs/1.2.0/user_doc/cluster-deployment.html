<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="keywords" content="cluster-deployment">
  <meta name="description" content="cluster-deployment">
  <title>cluster-deployment</title>
  <link rel="shortcut icon" href="/img/favicon.ico">
  <link rel="stylesheet" href="/build/vendor.eeae4ed.css">
</head>
<body>
  <div id="root"><div class="md2html docs-page" data-reactroot=""><header class="header-container header-container-dark"><div class="banner-tips"><div>🤔 Have queries regarding Apache DolphinScheduler, Join Slack channel to disscuss them <a class="link-tips" href="https://s.apache.org/dolphinscheduler-slack">join #dolphinscheduler channel</a>! 🌟</div></div><div class="header-body"><span class="mobile-menu-btn mobile-menu-btn-dark"></span><a href="/en-us/index.html"><img class="logo" src="/img/hlogo_white.svg"/></a><div class="search search-dark"><span class="icon-search"></span></div><span class="language-switch language-switch-dark">中</span><div class="header-menu"><div><ul class="ant-menu whiteClass ant-menu-light ant-menu-root ant-menu-horizontal" role="menu"><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/index.html" target="_self">HOME</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-item-selected" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span class="submenu-title-wrapper"><a href="/en-us/docs/latest/user_doc/about/introduction.html" target="_self">DOCS</a></span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/download/download.html" target="_self">DOWNLOAD</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/blog/index.html" target="_self">BLOG</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/development/development-environment-setup.html" target="_self">DEVELOPMENT</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/community/team.html" target="_self">COMMUNITY</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-submenu ant-menu-submenu-horizontal" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span class="submenu-title-wrapper"><a href="https://www.apache.org/" target="_blank">ASF</a></span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/user/index.html" target="_self">USER</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul></div></div><div class="mobile-menu"><div class="mobile-menu-content"><div class="mobile-menu-list"><div class="mobile-menu-item"><a class="mobile-menu-title" href="/en-us/index.html" target="_self">HOME</a></div><div class="mobile-menu-item"><a class="mobile-menu-title" href="/en-us/docs/latest/user_doc/about/introduction.html" target="_self">DOCS</a><em class="mobile-menu-icon"></em><div class="mobile-sub-menus"><div class="mobile-sub-menu-item"><a href="/en-us/docs/latest/user_doc/about/introduction.html" target="_self">latest(3.0.0-beta-2)</a></div><div class="mobile-sub-menu-item"><a href="/en-us/docs/2.0.6/user_doc/guide/quick-start.html" target="_self">2.0.6</a></div><div class="mobile-sub-menu-item"><a href="/en-us/docs/release/history-versions.html" target="_self">Older Versions</a></div></div></div><div class="mobile-menu-item"><a class="mobile-menu-title" href="/en-us/download/download.html" target="_self">DOWNLOAD</a></div><div class="mobile-menu-item"><a class="mobile-menu-title" href="/en-us/blog/index.html" target="_self">BLOG</a></div><div class="mobile-menu-item"><a class="mobile-menu-title" href="/en-us/development/development-environment-setup.html" target="_self">DEVELOPMENT</a></div><div class="mobile-menu-item"><a class="mobile-menu-title" href="/en-us/community/team.html" target="_self">COMMUNITY</a></div><div class="mobile-menu-item"><a class="mobile-menu-title" href="https://www.apache.org/" target="_blank">ASF</a><em class="mobile-menu-icon"></em><div class="mobile-sub-menus"><div class="mobile-sub-menu-item"><a href="https://www.apache.org/" target="_blank">Foundation</a></div><div class="mobile-sub-menu-item"><a href="https://www.apache.org/licenses/" target="_blank">License</a></div><div class="mobile-sub-menu-item"><a href="https://www.apache.org/events/current-event" target="_blank">Events</a></div><div class="mobile-sub-menu-item"><a href="https://www.apache.org/security/" target="_blank">Security</a></div><div class="mobile-sub-menu-item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank">Sponsorship</a></div><div class="mobile-sub-menu-item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank">Thanks</a></div></div></div><div class="mobile-menu-item"><a class="mobile-menu-title" href="/en-us/user/index.html" target="_self">USER</a></div></div></div><div class="mobile-menu-dummy"></div></div></div></header><section class="content-section"><div class="sidemenu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span>Deployment Document</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.2.0/user_doc/hardware-environment.html" target="_self">Hardware Environment</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.2.0/user_doc/standalone-deployment.html" target="_self">Standalone Deployment</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.2.0/user_doc/cluster-deployment.html" target="_self">Cluster Deployment</a></li></ul></li><li class="menu-item menu-item-level-1"><span>User Manual</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.2.0/user_doc/quick-start.html" target="_self">Quick Start</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.2.0/user_doc/system-manual.html" target="_self">User Manual</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.2.0/user_doc/metadata-1.2.html" target="_self">Metadata</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/1.2.0/user_doc/deployparam.html" target="_self">Deploy Param</a></li></ul></li><li class="menu-item menu-item-level-1"><span>Upgrade</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/1.2.0/user_doc/upgrade.html" target="_self">Upgrade</a></li></ul></li><li class="menu-item menu-item-level-1"><span>FAQ</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/release/faq.html" target="_self">FAQ</a></li></ul></li></ul></div><div class="doc-content markdown-body"><h1>Cluster Deployment</h1>
<p>DolphinScheduler Cluster deployment is divided into two parts: backend deployment and frontend deployment.</p>
<h1>1、Backend Deployment</h1>
<h3>1.1: Before you begin (please install requirement basic software by yourself)</h3>
<ul>
<li><a href="https://www.postgresql.org/download/">PostgreSQL</a> (8.2.15+) or <a href="https://dev.mysql.com/downloads/mysql/">MySQL</a> (5.7) : Choose One</li>
<li><a href="https://www.oracle.com/technetwork/java/javase/downloads/index.html">JDK</a> (1.8+) : Required. Double-check configure JAVA_HOME and PATH environment variables in /etc/profile</li>
<li><a href="https://zookeeper.apache.org/releases.html">ZooKeeper</a> (3.4.6+) : Required</li>
<li>pstree or psmisc : &quot;pstree&quot; is required for Mac OS and &quot;psmisc&quot; is required for Fedora/Red/Hat/CentOS/Ubuntu/Debian</li>
<li><a href="https://hadoop.apache.org/releases.html">Hadoop</a> (2.6+) or <a href="https://min.io/download">MinIO</a> : Optional. If you need to upload a resource function, you can choose a local file directory as the upload folder for a single machine (this operation does not need to deploy Hadoop). Of course, you can also choose to upload to Hadoop or MinIO.</li>
</ul>
<pre><code class="language-markdown"> Tips: DolphinScheduler itself does not rely on Hadoop, Hive, Spark, only use their clients for the corresponding task of running.
</code></pre>
<h3>1.2: Download the backend package.</h3>
<ul>
<li>Please download the latest version of the default installation package to the server deployment directory. For example, use /opt/dolphinscheduler as the installation and deployment directory. Download address: <a href="/en-us/download/download.html">download</a> (Take 1.2.0 for an example). Download the package and move to the installation and deployment directory. Then uncompress it.</li>
</ul>
<pre><code class="language-shell"><span class="hljs-meta">#</span><span class="bash"> Create the deployment directory. Do not choose a deployment directory with a high-privilege directory such as / root or / home.</span>
mkdir -p /opt/dolphinscheduler;
cd /opt/dolphinscheduler;
<span class="hljs-meta">#</span><span class="bash"> uncompress</span>
tar -zxvf apache-dolphinscheduler-incubating-1.2.0-dolphinscheduler-backend-bin.tar.gz -C /opt/dolphinscheduler;

mv apache-dolphinscheduler-incubating-1.2.0-dolphinscheduler-backend-bin  dolphinscheduler-backend
</code></pre>
<h3>1.3：Create deployment user and hosts mapping</h3>
<ul>
<li>Create a deployment user on the ** all ** deployment machines, and be sure to configure sudo passwordless. If we plan to deploy DolphinScheduler on 4 machines: ds1, ds2, ds3, and ds4, we first need to create a deployment user on each machine.</li>
</ul>
<pre><code class="language-shell"><span class="hljs-meta">#</span><span class="bash"> To create a user, you need to <span class="hljs-built_in">log</span> <span class="hljs-keyword">in</span> as root and <span class="hljs-built_in">set</span> the deployment user name. Please modify it yourself. The following uses dolphinscheduler as an example.</span>
useradd dolphinscheduler;
<span class="hljs-meta">
#</span><span class="bash"> Set the user password, please modify it yourself. The following takes dolphinscheduler123 as an example.</span>
echo &quot;dolphinscheduler123&quot; | passwd --stdin dolphinscheduler
<span class="hljs-meta">
#</span><span class="bash"> Configure sudo passwordless</span>
echo &#x27;dolphinscheduler  ALL=(ALL)  NOPASSWD: NOPASSWD: ALL&#x27; &gt;&gt; /etc/sudoers
sed -i &#x27;s/Defaults    requirett/#Defaults    requirett/g&#x27; /etc/sudoers
</code></pre>
<pre><code> Notes：
 - Because the task execution service is based on 'sudo -u {linux-user}' to switch between different Linux users to implement multi-tenant running jobs, the deployment user needs to have sudo permissions and is passwordless. The first-time learners who can ignore it if they don't understand.
 - If find the &quot;Default requiretty&quot; in the &quot;/etc/sudoers&quot; file, also comment out.
 - If you need to use resource upload, you need to assign the user of permission to operate the local file system, HDFS or MinIO.
</code></pre>
<h3>1.4 : Configure hosts mapping and ssh access and modify directory permissions.</h3>
<ul>
<li>
<p>Use the first machine (hostname is ds1) as the deployment machine, configure the hosts of all machines to be deployed on ds1, and login as root on ds1.</p>
<pre><code class="language-shell">vi /etc/hosts
<span class="hljs-meta">
#</span><span class="bash"> add ip hostname</span>
192.168.xxx.xxx ds1
192.168.xxx.xxx ds2
192.168.xxx.xxx ds3
192.168.xxx.xxx ds4
</code></pre>
<p><em>Note: Please delete or comment out the line 127.0.0.1</em></p>
</li>
<li>
<p>Sync /etc/hosts on ds1 to all deployment machines</p>
<pre><code class="language-shell">for ip in ds2 ds3;     # Please replace ds2 ds3 here with the hostname of machines you want to deploy
do
    sudo scp -r /etc/hosts  $ip:/etc/          # Need to enter root password during operation
done
</code></pre>
<p><em>Note: can use <code>sshpass -p xxx sudo scp -r /etc/hosts $ip:/etc/</code> to avoid type password.</em></p>
<blockquote>
<p>Install sshpass in Centos:</p>
<ol>
<li>
<p>Install epel</p>
<p>yum install -y epel-release</p>
<p>yum repolist</p>
</li>
<li>
<p>After installing epel, you can install sshpass</p>
<p>yum install -y sshpass</p>
</li>
</ol>
</blockquote>
</li>
<li>
<p>On ds1, switch to the deployment user and configure ssh passwordless login</p>
<pre><code class="language-shell">su dolphinscheduler;

ssh-keygen -t rsa -P &#x27;&#x27; -f ~/.ssh/id_rsa
cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys
chmod 600 ~/.ssh/authorized_keys
</code></pre>
<p>Note: <em>If configure success, the dolphinscheduler user does not need to enter a password when executing the command <code>ssh localhost</code></em></p>
</li>
<li>
<p>On ds1, configure the deployment user dolphinscheduler ssh to connect to other machines to be deployed.</p>
<pre><code class="language-shell">su dolphinscheduler;
for ip in ds2 ds3;     # Please replace ds2 ds3 here with the hostname of the machine you want to deploy.
do
    ssh-copy-id  $ip   # You need to manually enter the password of the dolphinscheduler user during the operation.
done
<span class="hljs-meta">#</span><span class="bash"> can use `sshpass -p xxx ssh-copy-id <span class="hljs-variable">$ip</span>` to avoid <span class="hljs-built_in">type</span> password.</span>
</code></pre>
</li>
<li>
<p>On ds1, modify the directory permissions so that the deployment user has operation permissions on the dolphinscheduler-backend directory.</p>
<pre><code class="language-shell">sudo chown -R dolphinscheduler:dolphinscheduler dolphinscheduler-backend
</code></pre>
</li>
</ul>
<h3>1.5: Database initialization</h3>
<ul>
<li>Into the database. The default database is PostgreSQL. If you select MySQL, you need to add the mysql-connector-java driver package to the lib directory of DolphinScheduler.</li>
</ul>
<pre><code>mysql -uroot -p
</code></pre>
<ul>
<li>After entering the database command line window, execute the database initialization command and set the user and password. <strong>Note: {user} and {password} need to be replaced with a specific database username and password</strong></li>
</ul>
<pre><code class="language-mysql">   mysql&gt; CREATE DATABASE dolphinscheduler DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;
   mysql&gt; GRANT ALL PRIVILEGES ON dolphinscheduler.* TO &#x27;{user}&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;{password}&#x27;;
   mysql&gt; GRANT ALL PRIVILEGES ON dolphinscheduler.* TO &#x27;{user}&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;{password}&#x27;;
   mysql&gt; flush privileges;
</code></pre>
<ul>
<li>
<p>Create tables and import basic data</p>
<ul>
<li>Modify the following configuration in application-dao.properties under the conf directory</li>
</ul>
<pre><code class="language-shell">  vi conf/application-dao.properties 
</code></pre>
<ul>
<li>If you choose Mysql, please comment out the relevant configuration of PostgreSQL (vice versa), you also need to manually add the [[mysql-connector-java driver jar] (<a href="https://downloads.mysql.com/archives/c-j/">https://downloads.mysql.com/archives/c-j/</a>) package to lib under the directory, and then configure the database connection information correctly.</li>
</ul>
<pre><code class="language-properties"><span class="hljs-comment">  #postgre</span>
<span class="hljs-comment">  #spring.datasource.driver-class-name=org.postgresql.Driver</span>
<span class="hljs-comment">  #spring.datasource.url=jdbc:postgresql://localhost:5432/dolphinscheduler</span>
<span class="hljs-comment">  # mysql</span>
  <span class="hljs-meta">spring.datasource.driver-class-name</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span>
  <span class="hljs-meta">spring.datasource.url</span>=<span class="hljs-string">jdbc:mysql://xxx:3306/dolphinscheduler?useUnicode=true&amp;characterEncoding=UTF-8  # Replace the correct IP address</span>
  <span class="hljs-meta">spring.datasource.username</span>=<span class="hljs-string">xxx						# replace the currect {user} value</span>
  <span class="hljs-meta">spring.datasource.password</span>=<span class="hljs-string">xxx						# replace the currect {password} value</span>
</code></pre>
<ul>
<li>After modifying and saving, execute the create table and import data script in the script directory.</li>
</ul>
<pre><code class="language-shell">sh script/create-dolphinscheduler.sh
</code></pre>
</li>
</ul>
<p>​       <em>Note: If you execute the above script and report &quot;/bin/java: No such file or directory&quot; error, please configure JAVA_HOME and PATH variables in /etc/profile</em></p>
<h3>1.6: Modify runtime parameters.</h3>
<ul>
<li>
<p>Modify the environment variable in <code>.dolphinscheduler_env.sh</code> file which on the 'conf/env' directory (take the relevant software installed under '/opt/soft' as an example)</p>
<pre><code class="language-shell">export HADOOP_HOME=/opt/soft/hadoop
export HADOOP_CONF_DIR=/opt/soft/hadoop/etc/hadoop
<span class="hljs-meta">#</span><span class="bash"><span class="hljs-built_in">export</span> SPARK_HOME1=/opt/soft/spark1</span>
export SPARK_HOME2=/opt/soft/spark2
export PYTHON_HOME=/opt/soft/python
export JAVA_HOME=/opt/soft/java
export HIVE_HOME=/opt/soft/hive
export FLINK_HOME=/opt/soft/flink
export PATH=$HADOOP_HOME/bin:$SPARK_HOME2/bin:$PYTHON_HOME:$JAVA_HOME/bin:$HIVE_HOME/bin:$PATH:$FLINK_HOME/bin:$PATH
</code></pre>
<pre><code>`Note: This step is very important. For example, JAVA_HOME and PATH must be configured. Those that are not used can be ignored or commented out. If &quot;.dolphinscheduler_env.sh&quot; cannot be found, run &quot;ls -a&quot;`
</code></pre>
</li>
<li>
<p>Create Soft link jdk to /usr/bin/java (still JAVA_HOME=/opt/soft/java as an example)</p>
<pre><code class="language-shell">sudo ln -s /opt/soft/java/bin/java /usr/bin/java
</code></pre>
</li>
<li>
<p>Modify the parameters in the one-click deployment script <code>install.sh</code>, pay special attention to the configuration of the following parameters.</p>
<pre><code class="language-shell"><span class="hljs-meta">#</span><span class="bash"> Choose mysql or postgresql</span>
dbtype=&quot;mysql&quot;
<span class="hljs-meta">
#</span><span class="bash"> Database connection address</span>
dbhost=&quot;192.168.xx.xx:3306&quot;
<span class="hljs-meta">
#</span><span class="bash"> Database schema name</span>
dbname=&quot;dolphinscheduler&quot;
<span class="hljs-meta">
#</span><span class="bash"> Database username</span>
username=&quot;xxx&quot;    
<span class="hljs-meta">
#</span><span class="bash"> Database password, <span class="hljs-keyword">if</span> there are special characters, please use <span class="hljs-string">&#x27;\&#x27;</span> escape, you need to modify the specific value of {passowrd} <span class="hljs-built_in">set</span> above</span>
passowrd=&quot;xxx&quot;
<span class="hljs-meta">
#</span><span class="bash"> The directory <span class="hljs-built_in">where</span> DS is installed, such as: <span class="hljs-string">&#x27;/opt/soft/dolphinscheduler&#x27;</span>, <span class="hljs-built_in">which</span> is different from the current directory.</span>
installPath=&quot;/opt/soft/dolphinscheduler&quot;
<span class="hljs-meta">
#</span><span class="bash"> The system user created <span class="hljs-keyword">in</span> section 1.3.</span>
deployUser=&quot;dolphinscheduler&quot;
<span class="hljs-meta">
#</span><span class="bash"> Zookeeper cluster address</span>
zkQuorum=&quot;192.168.xx.xx:2181,192.168.xx.xx:2181,192.168.xx.xx:2181&quot;
<span class="hljs-meta">
#</span><span class="bash"> On machines <span class="hljs-built_in">which</span> the DS service is deployed</span>
ips=&quot;ds1,ds2,ds3,ds4&quot;
<span class="hljs-meta">
#</span><span class="bash"> On machines <span class="hljs-built_in">which</span> the master service is deployed</span>
masters=&quot;ds1,ds2&quot;
<span class="hljs-meta">
#</span><span class="bash"> On machines <span class="hljs-built_in">which</span> the worker service is deployed</span>
workers=&quot;ds3,ds4&quot;
<span class="hljs-meta">
#</span><span class="bash"> On machines <span class="hljs-built_in">which</span> the alert service is deployed</span>
alertServer=&quot;ds2&quot;
<span class="hljs-meta">
#</span><span class="bash"> On machines <span class="hljs-built_in">which</span> the api service is deployed</span>
apiServers=&quot;ds1&quot;
<span class="hljs-meta">

#</span><span class="bash"> EMail configuration, taking QQ mailbox as an example</span>
<span class="hljs-meta">#</span><span class="bash"> EMail protocol</span>
mailProtocol=&quot;SMTP&quot;
<span class="hljs-meta">
#</span><span class="bash"> EMail server address</span>
mailServerHost=&quot;smtp.exmail.qq.com&quot;
<span class="hljs-meta">
#</span><span class="bash"> EMail server Port</span>
mailServerPort=&quot;25&quot;
<span class="hljs-meta">
#</span><span class="bash"> mailSender and mailUser can be the same one.</span>
<span class="hljs-meta">#</span><span class="bash"> Sender</span>
mailSender=&quot;xxx@qq.com&quot;
<span class="hljs-meta">
#</span><span class="bash"> Receiver</span>
mailUser=&quot;xxx@qq.com&quot;
<span class="hljs-meta">
#</span><span class="bash"> EMail password</span>
mailPassword=&quot;xxx&quot;
<span class="hljs-meta">
#</span><span class="bash"> Set <span class="hljs-literal">true</span> <span class="hljs-keyword">if</span> the mailbox is TLS protocol, otherwise <span class="hljs-built_in">set</span> to <span class="hljs-literal">false</span>.</span>
starttlsEnable=&quot;true&quot;
<span class="hljs-meta">
#</span><span class="bash"> Mail service address value, refer to mailServerHost above.</span>
sslTrust=&quot;smtp.exmail.qq.com&quot;
<span class="hljs-meta">
#</span><span class="bash"> Set <span class="hljs-literal">true</span> <span class="hljs-keyword">if</span> the mailbox is SSL protocol, otherwise <span class="hljs-built_in">set</span> to <span class="hljs-literal">false</span>. Note: starttlsEnable and sslEnable cannot be <span class="hljs-literal">true</span> at the same time.</span>
sslEnable=&quot;false&quot;
<span class="hljs-meta">
#</span><span class="bash"> Download path of excel</span>
xlsFilePath=&quot;/tmp/xls&quot;
<span class="hljs-meta">
#</span><span class="bash"> Where are some sql and other resource files used <span class="hljs-keyword">for</span> business uploaded. Can be <span class="hljs-built_in">set</span>: HDFS, S3, NONE. If a standalone wants to use the <span class="hljs-built_in">local</span> file system, please configure it as HDFS, because HDFS supports the <span class="hljs-built_in">local</span> file system; <span class="hljs-keyword">if</span> you <span class="hljs-keyword">do</span> not need the resource upload <span class="hljs-keyword">function</span>, select NONE. One important point: using a <span class="hljs-built_in">local</span> file system does not require the deployment of Hadoop.</span>
resUploadStartupType=&quot;HDFS&quot;
<span class="hljs-meta">
#</span><span class="bash"> Note: If you want to upload to HDFS and the NameNode has HA enabled, you need to put core-site.xml and hdfs-site.xml <span class="hljs-keyword">in</span> the installPath/conf directory. In this example, it is placed under /opt/soft/dolphinscheduler/conf, and Configure the namenode cluster name; <span class="hljs-keyword">if</span> the NameNode is not HA, modify it to a specific IP or host name.</span>
defaultFS=&quot;hdfs://mycluster:8020&quot;
<span class="hljs-meta">

#</span><span class="bash"> If the ResourceManager is HA, configure it as the active-standby IP or hostname of the ResourceManager node, such as <span class="hljs-string">&quot;192.168.xx.xx, 192.168.xx.xx&quot;</span>; otherwise, <span class="hljs-keyword">if</span> it is a single ResourceManager or yarn is not used at all, please configure yarnHaIps = <span class="hljs-string">&quot;&quot;</span>. That<span class="hljs-string">&#x27;s it, I don&#x27;</span>t use yarn here, the configuration is <span class="hljs-string">&quot;&quot;</span>.</span>
yarnHaIps=&quot;&quot;
<span class="hljs-meta">
#</span><span class="bash"> If it is a single ResourceManager, configure it as the ResourceManager node ip or hostname, otherwise, keep the default value. Yarn is not used here, keep the default.</span>
singleYarnIp=&quot;ark1&quot;
</code></pre>
<p><em>Attention:</em></p>
<ul>
<li>If you need to upload resources to the Hadoop cluster, and the NameNode of the Hadoop cluster is configured with HA, you need to enable HDFS resource upload, and you need to copy the core-site.xml and hdfs-site.xml in the Hadoop cluster to /opt/ dolphinscheduler/conf. Non-NameNode HA skips the next step.</li>
</ul>
</li>
</ul>
<h3>1.7: Install python's Zookeeper tool kazoo</h3>
<ul>
<li>Install python's Zookeeper tool. <code>This step is only used for one-click deployment.</code></li>
</ul>
<pre><code class="language-shell"><span class="hljs-meta">#</span><span class="bash"> Install pip</span>
sudo yum -y install python-pip;  # ubuntu: sudo apt-get install python-pip
sudo pip install kazoo;
</code></pre>
<p><em>Note: If yum does not find python-pip, you can also install it by following commands</em></p>
<pre><code class="language-shell">sudo curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py
sudo python get-pip.py  # 如果是python3，使用sudo python3 get-pip.py 
<span class="hljs-meta">#</span><span class="bash"> <span class="hljs-keyword">then</span></span>
sudo pip install kazoo;
</code></pre>
<ul>
<li>
<p>Switch to the deployment user and execute the one-click deployment script</p>
<p><code>sh install.sh</code></p>
</li>
</ul>
<pre><code>Note:
For the first deployment, the following message appears in step 3 of `3, stop server` during operation. This message can be ignored.
sh: bin/dolphinscheduler-daemon.sh: No such file or directory
</code></pre>
<ul>
<li>After the script is completed, the following 5 services will be started. Use the <code>jps</code> command to check whether the services are started (<code>jps</code> comes with <code>java JDK</code>)</li>
</ul>
<pre><code class="language-aidl">    MasterServer         ----- master service
    WorkerServer         ----- worker service
    LoggerServer         ----- logger service
    ApiApplicationServer ----- api service
    AlertServer          ----- alert service
</code></pre>
<p>If the above services are started normally, the automatic deployment is successful.</p>
<p>After the deployment is successful, you can view the logs. The logs are stored in the logs folder.</p>
<pre><code class="language-log"> logs/
    ├── dolphinscheduler-alert-server.log
    ├── dolphinscheduler-master-server.log
    |—— dolphinscheduler-worker-server.log
    |—— dolphinscheduler-api-server.log
    |—— dolphinscheduler-logger-server.log
</code></pre>
<h1>2. Frontend Deployment</h1>
<p>Please download the latest version of the frontend installation package to the server deployment directory, download address: [Download] (/en-us/download/download.html) (Take 1.2.0 version as an example ), Upload the tar.gz package to this directory after downloading and uncompress it.</p>
<pre><code class="language-shell">cd /opt/dolphinscheduler;

tar -zxvf apache-dolphinscheduler-incubating-1.2.0-dolphinscheduler-front-bin.tar.gz -C /opt/dolphinscheduler;

mv apache-dolphinscheduler-incubating-1.2.0-dolphinscheduler-front-bin dolphinscheduler-ui
</code></pre>
<p><strong>Choose any one of the following methods, automated deployment is recommended.</strong></p>
<h3>2.1 Automated Deployment</h3>
<ul>
<li>
<p>Enter the dolphinscheduler-ui directory and execute (<code>Note: Automated deployment will automatically download nginx</code>)</p>
<pre><code class="language-shell">cd dolphinscheduler-ui;
sh ./install-dolphinscheduler-ui.sh;
</code></pre>
<ul>
<li>After the execution, please type the frontend port during operation, the default port is 8888, if you choose the default, please press enter directly, or type another port.</li>
<li>Then it will let you type the api-server ip that interacts with the frontend UI.</li>
<li>Next is the port of the api-server that lets you type to interact with the frontend UI.</li>
<li>Next is the operating system selection.</li>
<li>Wait for deployment to complete.</li>
</ul>
</li>
<li>
<p>After deployment, in order to prevent too large resources from uploading to the resource center, it is recommended to modify the nginx upload size parameters, as follows:</p>
<ul>
<li>Add Nginx configuration client_max_body_size 1024m, you can add it in the http method body.</li>
</ul>
<pre><code class="language-shell">vi /etc/nginx/nginx.conf
<span class="hljs-meta">
#</span><span class="bash"> add param</span>
client_max_body_size 1024m;
</code></pre>
<ul>
<li>Then restart Nginx service</li>
</ul>
<pre><code class="language-shell">systemctl restart nginx
</code></pre>
</li>
<li>
<p>Visit the front page address: <a href="http://localhost:8888">http://localhost:8888</a>. If the front login page appears, the front web installation is complete.</p>
<p>default user password：admin/dolphinscheduler123</p>
<p align="center">
   <img src="/img/login.png" width="60%" />
 </p>
</li>
</ul>
<h3>2.2 Manual Deployment</h3>
<ul>
<li>
<p>Install nginx by yourself, download it from the official website: Or <code>yum install nginx -y</code></p>
</li>
<li>
<p>Modify the nginx configuration file (Note: some place need to be modified by yourself)</p>
</li>
</ul>
<pre><code class="language-html">vi /etc/nginx/nginx.conf

server {
    listen       8888; # Your Port
    server_name  localhost;
    #charset koi8-r;
    #access_log  /var/log/nginx/host.access.log  main;
    location / {
        root   /opt/soft/dolphinscheduler-ui/dist;      # Your dist directory which 
        index  index.html index.html;
    }
    location /dolphinscheduler {
        proxy_pass http://localhost:12345;    # Your ApiApplicationServer address
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header x_real_ipP $remote_addr;
        proxy_set_header remote_addr $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_http_version 1.1;
        proxy_connect_timeout 4s;
        proxy_read_timeout 30s;
        proxy_send_timeout 12s;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection &quot;upgrade&quot;;
    }
    #error_page  404              /404.html;
    # redirect server error pages to the static page /50x.html
    #
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }
}
</code></pre>
<ul>
<li>
<p>Then restart Nginx service</p>
<pre><code class="language-shell">systemctl restart nginx
</code></pre>
</li>
<li>
<p>Visit the front page address: <a href="http://localhost:8888">http://localhost:8888</a>. If the front login page appears, the front web installation is complete.</p>
<p>default user password：admin/dolphinscheduler123</p>
<p align="center">
   <img src="/img/login.png" width="60%" />
 </p>
</li>
</ul>
<h1>3. Start and stop service</h1>
<ul>
<li>
<p>Stop all services</p>
<p><code>sh ./bin/stop-all.sh</code></p>
</li>
<li>
<p>Start all services</p>
<p><code>sh ./bin/start-all.sh</code></p>
</li>
<li>
<p>Start and stop master service</p>
</li>
</ul>
<pre><code class="language-shell">sh ./bin/dolphinscheduler-daemon.sh start master-server
sh ./bin/dolphinscheduler-daemon.sh stop master-server
</code></pre>
<ul>
<li>Start and stop worker Service</li>
</ul>
<pre><code class="language-shell">sh ./bin/dolphinscheduler-daemon.sh start worker-server
sh ./bin/dolphinscheduler-daemon.sh stop worker-server
</code></pre>
<ul>
<li>Start and stop api Service</li>
</ul>
<pre><code class="language-shell">sh ./bin/dolphinscheduler-daemon.sh start api-server
sh ./bin/dolphinscheduler-daemon.sh stop api-server
</code></pre>
<ul>
<li>Start and stop logger Service</li>
</ul>
<pre><code class="language-shell">sh ./bin/dolphinscheduler-daemon.sh start logger-server
sh ./bin/dolphinscheduler-daemon.sh stop logger-server
</code></pre>
<ul>
<li>Start and stop alert service</li>
</ul>
<pre><code class="language-shell">sh ./bin/dolphinscheduler-daemon.sh start alert-server
sh ./bin/dolphinscheduler-daemon.sh stop alert-server
</code></pre>
<p><code>Note: Please refer to the &quot;Architecture Design&quot; section for service usage</code></p>
</div></section><footer class="footer-container"><div class="footer-body"><div><h3>About us</h3><h4>Do you need feedback? Please contact us through the following ways.</h4></div><div class="contact-container"><ul><li><a href="/en-us/community/development/subscribe.html"><img class="img-base" src="/img/emailgray.png"/><img class="img-change" src="/img/emailblue.png"/><p>Email List</p></a></li><li><a href="https://twitter.com/dolphinschedule"><img class="img-base" src="/img/twittergray.png"/><img class="img-change" src="/img/twitterblue.png"/><p>Twitter</p></a></li><li><a href="https://stackoverflow.com/questions/tagged/apache-dolphinscheduler"><img class="img-base" src="/img/stackoverflow.png"/><img class="img-change" src="/img/stackoverflow-selected.png"/><p>Stack Overflow</p></a></li><li><a href="https://s.apache.org/dolphinscheduler-slack"><img class="img-base" src="/img/slack.png"/><img class="img-change" src="/img/slack-selected.png"/><p>Slack</p></a></li></ul></div><div class="cols-container"><div class="docu-container"><h4>Documentation</h4><ul><li><a href="/en-us/development/architecture-design.html"><p>Overview</p></a></li><li><a href="/en-us/docs/latest/user_doc/guide/quick-start.html"><p>Quick start</p></a></li><li><a href="/en-us/development/development-environment-setup.html"><p>Developer guide</p></a></li></ul></div><div></div><div class="asf-container"><h4>ASF</h4><ul><li><a href="http://www.apache.org"><p>Foundation</p></a></li><li><a href="http://www.apache.org/licenses/"><p>License</p></a></li><li><a href="http://www.apache.org/events/current-event"><p>Events</p></a></li><li><a href="http://www.apache.org/foundation/sponsorship.html"><p>Sponsorship</p></a></li><li><a href="http://www.apache.org/foundation/thanks.html"><p>Thanks</p></a></li></ul></div></div><div class="copyright"><span>Copyright © 2019-2021 The Apache Software Foundation. Apache DolphinScheduler, DolphinScheduler, and its feather logo are trademarks of The Apache Software Foundation.</span></div></div></footer></div></div>
  <script src="/asset/js/react/react-with-addons.min.js"></script>
  <script src="/asset/js/react/react-dom.min.js"></script>
  <script>window.rootPath = '';</script>
  <script src="/build/vendor.36e600e.js"></script>
  <script src="/build/docs.md.3b4329a.js"></script>
  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d6bc736fd9885d9a5dc938425ac062ad";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-899J8PYKJZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-899J8PYKJZ');
  </script>
</body>
</html>