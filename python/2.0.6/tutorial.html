

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial &mdash; apache-dolphinscheduler 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=d45e8c67"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/tabs.js?v=3ee01567"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Concepts" href="concept.html" />
    <link rel="prev" title="Getting Started" href="start.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            apache-dolphinscheduler
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="start.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview-of-tutorial">Overview of Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="#import-necessary-module">Import Necessary Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#process-definition-declaration">Process Definition Declaration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task-declaration">Task Declaration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-task-dependence">Setting Task Dependence</a></li>
<li class="toctree-l2"><a class="reference internal" href="#submit-or-run-workflow">Submit Or Run Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dag-graph-after-tutorial-run">DAG Graph After Tutorial Run</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="concept.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks/index.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">apache-dolphinscheduler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Link to this heading"></a></h1>
<p>This tutorial show you the basic concept of <em>PyDolphinScheduler</em> and tell all
things you should know before you submit or run your first workflow. If you
still not install <em>PyDolphinScheduler</em> and start Apache DolphinScheduler, you
could go and see <a class="reference internal" href="start.html#getting-started"><span class="std std-ref">how to getting start PyDolphinScheduler</span></a></p>
<section id="overview-of-tutorial">
<h2>Overview of Tutorial<a class="headerlink" href="#overview-of-tutorial" title="Link to this heading"></a></h2>
<p>Here have an overview of our tutorial, and it look a little complex but do not
worry about that because we explain this example below as detailed as possible.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># [start package_import]</span>
<span class="c1"># Import ProcessDefinition object to define your workflow attributes</span>
<span class="kn">from</span> <span class="nn">pydolphinscheduler.core.process_definition</span> <span class="kn">import</span> <span class="n">ProcessDefinition</span>

<span class="c1"># Import task Shell object cause we would create some shell tasks later</span>
<span class="kn">from</span> <span class="nn">pydolphinscheduler.tasks.shell</span> <span class="kn">import</span> <span class="n">Shell</span>

<span class="c1"># [end package_import]</span>

<span class="c1"># [start workflow_declare]</span>
<span class="k">with</span> <span class="n">ProcessDefinition</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;tutorial&quot;</span><span class="p">,</span>
    <span class="n">schedule</span><span class="o">=</span><span class="s2">&quot;0 0 0 * * ? *&quot;</span><span class="p">,</span>
    <span class="n">start_time</span><span class="o">=</span><span class="s2">&quot;2021-01-01&quot;</span><span class="p">,</span>
    <span class="n">tenant</span><span class="o">=</span><span class="s2">&quot;tenant_exists&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">pd</span><span class="p">:</span>
    <span class="c1"># [end workflow_declare]</span>
    <span class="c1"># [start task_declare]</span>
    <span class="n">task_parent</span> <span class="o">=</span> <span class="n">Shell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;task_parent&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="s2">&quot;echo hello pydolphinscheduler&quot;</span><span class="p">)</span>
    <span class="n">task_child_one</span> <span class="o">=</span> <span class="n">Shell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;task_child_one&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="s2">&quot;echo &#39;child one&#39;&quot;</span><span class="p">)</span>
    <span class="n">task_child_two</span> <span class="o">=</span> <span class="n">Shell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;task_child_two&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="s2">&quot;echo &#39;child two&#39;&quot;</span><span class="p">)</span>
    <span class="n">task_union</span> <span class="o">=</span> <span class="n">Shell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;task_union&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="s2">&quot;echo union&quot;</span><span class="p">)</span>
    <span class="c1"># [end task_declare]</span>

    <span class="c1"># [start task_relation_declare]</span>
    <span class="n">task_group</span> <span class="o">=</span> <span class="p">[</span><span class="n">task_child_one</span><span class="p">,</span> <span class="n">task_child_two</span><span class="p">]</span>
    <span class="n">task_parent</span><span class="o">.</span><span class="n">set_downstream</span><span class="p">(</span><span class="n">task_group</span><span class="p">)</span>

    <span class="n">task_union</span> <span class="o">&lt;&lt;</span> <span class="n">task_group</span>
    <span class="c1"># [end task_relation_declare]</span>

    <span class="c1"># [start submit_or_run]</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="c1"># [end submit_or_run]</span>
</pre></div>
</div>
</section>
<section id="import-necessary-module">
<h2>Import Necessary Module<a class="headerlink" href="#import-necessary-module" title="Link to this heading"></a></h2>
<p>First of all, we should importing necessary module which we would use later just
like other Python package. We just create a minimum demo here, so we just import
<code class="xref py py-class docutils literal notranslate"><span class="pre">pydolphinscheduler.core.process_definition</span></code> and
<a class="reference internal" href="tasks/shell.html#module-pydolphinscheduler.tasks.shell" title="pydolphinscheduler.tasks.shell"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydolphinscheduler.tasks.shell</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import ProcessDefinition object to define your workflow attributes</span>
<span class="kn">from</span> <span class="nn">pydolphinscheduler.core.process_definition</span> <span class="kn">import</span> <span class="n">ProcessDefinition</span>

<span class="c1"># Import task Shell object cause we would create some shell tasks later</span>
<span class="kn">from</span> <span class="nn">pydolphinscheduler.tasks.shell</span> <span class="kn">import</span> <span class="n">Shell</span>

</pre></div>
</div>
<p>If you want to use other task type you could click and
<a class="reference internal" href="tasks/index.html"><span class="doc">see all tasks we support</span></a></p>
</section>
<section id="process-definition-declaration">
<h2>Process Definition Declaration<a class="headerlink" href="#process-definition-declaration" title="Link to this heading"></a></h2>
<p>We should instantiate object after we import them from <a class="reference internal" href="#import-necessary-module">import necessary module</a>.
Here we declare basic arguments for process definition(aka, workflow). We define
the name of process definition, using <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#context-manager-types">Python context manager</a> and it
<strong>the only required argument</strong> for object process definition. Beside that we also
declare three arguments named <cite>schedule</cite>, <cite>start_time</cite> which setting workflow schedule
interval and schedule start_time, and argument <cite>tenant</cite> which changing workflow’s
task running user in the worker, <a class="reference internal" href="concept.html#tenant"><span class="std std-ref">section tenant</span></a> in <em>PyDolphinScheduler</em>
<a class="reference internal" href="concept.html"><span class="doc">Concepts</span></a> page have more detail information.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ProcessDefinition</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;tutorial&quot;</span><span class="p">,</span>
    <span class="n">schedule</span><span class="o">=</span><span class="s2">&quot;0 0 0 * * ? *&quot;</span><span class="p">,</span>
    <span class="n">start_time</span><span class="o">=</span><span class="s2">&quot;2021-01-01&quot;</span><span class="p">,</span>
    <span class="n">tenant</span><span class="o">=</span><span class="s2">&quot;tenant_exists&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">pd</span><span class="p">:</span>
</pre></div>
</div>
<p>We could find more detail about process definition in
<a class="reference internal" href="concept.html#process-definition"><span class="std std-ref">concept about process definition</span></a> if you interested in it.
For all arguments of object process definition, you could find in the
<code class="xref py py-class docutils literal notranslate"><span class="pre">pydolphinscheduler.core.process_definition</span></code> api documentation.</p>
</section>
<section id="task-declaration">
<h2>Task Declaration<a class="headerlink" href="#task-declaration" title="Link to this heading"></a></h2>
<p>Here we declare four tasks, and bot of them are simple task of
<a class="reference internal" href="tasks/shell.html#module-pydolphinscheduler.tasks.shell" title="pydolphinscheduler.tasks.shell"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydolphinscheduler.tasks.shell</span></code></a> which running <cite>echo</cite> command in terminal.
Beside the argument <cite>command</cite>, we also need setting argument <cite>name</cite> for each task <em>(not
only shell task, `name` is required for each type of task)</em>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">task_parent</span> <span class="o">=</span> <span class="n">Shell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;task_parent&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="s2">&quot;echo hello pydolphinscheduler&quot;</span><span class="p">)</span>
    <span class="n">task_child_one</span> <span class="o">=</span> <span class="n">Shell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;task_child_one&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="s2">&quot;echo &#39;child one&#39;&quot;</span><span class="p">)</span>
    <span class="n">task_child_two</span> <span class="o">=</span> <span class="n">Shell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;task_child_two&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="s2">&quot;echo &#39;child two&#39;&quot;</span><span class="p">)</span>
    <span class="n">task_union</span> <span class="o">=</span> <span class="n">Shell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;task_union&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="s2">&quot;echo union&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Beside shell task, <em>PyDolphinScheduler</em> support multiple tasks and you could
find in <a class="reference internal" href="tasks/index.html"><span class="doc">Tasks</span></a>.</p>
</section>
<section id="setting-task-dependence">
<h2>Setting Task Dependence<a class="headerlink" href="#setting-task-dependence" title="Link to this heading"></a></h2>
<p>After we declare both process definition and task, we have one workflow with
four tasks, both all tasks is independent so that they would run in parallel.
We should reorder the sort and the dependence of tasks. It useful when we need
run prepare task before we run actual task or we need tasks running is specific
rule. We both support attribute <cite>set_downstream</cite> and <cite>set_upstream</cite>, or bitwise
operators <cite>&gt;&gt;</cite> and <cite>&lt;&lt;</cite>.</p>
<p>In this example, we set task <cite>task_parent</cite> is the upstream task of task
<cite>task_child_one</cite> and <cite>task_child_two</cite>, and task <cite>task_union</cite> is the downstream
task of both these two task.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">task_group</span> <span class="o">=</span> <span class="p">[</span><span class="n">task_child_one</span><span class="p">,</span> <span class="n">task_child_two</span><span class="p">]</span>
    <span class="n">task_parent</span><span class="o">.</span><span class="n">set_downstream</span><span class="p">(</span><span class="n">task_group</span><span class="p">)</span>

    <span class="n">task_union</span> <span class="o">&lt;&lt;</span> <span class="n">task_group</span>
</pre></div>
</div>
<p>Please notice that we could grouping some tasks and set dependence if they have
same downstream or upstream. We declare task <cite>task_child_one</cite> and <cite>task_child_two</cite>
as a group here, named as <cite>task_group</cite> and set task <cite>task_parent</cite> as upstream of
both of them. You could see more detail in <a class="reference internal" href="concept.html#tasks-dependence"><span class="std std-ref">Tasks Dependence</span></a> section in concept
documentation.</p>
</section>
<section id="submit-or-run-workflow">
<h2>Submit Or Run Workflow<a class="headerlink" href="#submit-or-run-workflow" title="Link to this heading"></a></h2>
<p>Now we finish our workflow definition, with task and task dependence, but all
these things are in local, we should let Apache DolphinScheduler daemon know what we
define our workflow. So the last thing we have to do here is submit our workflow to
Apache DolphinScheduler daemon.</p>
<p>We here in the example using <cite>ProcessDefinition</cite> attribute <cite>run</cite> to submit workflow
to the daemon, and set the schedule time we just declare in <a class="reference internal" href="#process-definition-declaration">process definition declaration</a>.</p>
<p>Now, we could run the Python code like other Python script, for the basic usage run
<code class="code docutils literal notranslate"><span class="pre">python</span> <span class="pre">tutorial.py</span></code> to trigger and run it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">pd</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>If you not start your Apache DolphinScheduler server, you could find the way in
<a class="reference internal" href="start.html#start-python-gateway-server"><span class="std std-ref">Start Python Gateway Server</span></a> and it would have more detail about related server
start. Beside attribute <cite>run</cite>, we have attribute <cite>submit</cite> for object <cite>ProcessDefinition</cite>
and it just submit workflow to the daemon but not setting the schedule information. For
more detail you could see <a class="reference internal" href="concept.html#process-definition"><span class="std std-ref">Process Definition</span></a>.</p>
</section>
<section id="dag-graph-after-tutorial-run">
<h2>DAG Graph After Tutorial Run<a class="headerlink" href="#dag-graph-after-tutorial-run" title="Link to this heading"></a></h2>
<p>After we run the tutorial code, you could login Apache DolphinScheduler web UI,
go and see the <a class="reference external" href="https://dolphinscheduler.apache.org/en-us/docs/latest/user_doc/guide/project.html">DolphinScheduler project page</a>. they is a new process definition be
created and named “Tutorial”. It create by <em>PyDolphinScheduler</em> and the DAG graph as below</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                  --&gt; task_child_one
                /                    \
task_parent --&gt;                        --&gt;  task_union
                \                    /
                  --&gt; task_child_two
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="start.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="concept.html" class="btn btn-neutral float-right" title="Concepts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, apache.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: 2.0.6
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="../2.0.5/tutorial.html">2.0.5</a></dd>
      <dd><a href="tutorial.html">2.0.6</a></dd>
      <dd><a href="../2.0.7/tutorial.html">2.0.7</a></dd>
      <dd><a href="../3.0.0/tutorial.html">3.0.0</a></dd>
      <dd><a href="../3.0.1/tutorial.html">3.0.1</a></dd>
      <dd><a href="../3.1.0/tutorial.html">3.1.0</a></dd>
      <dd><a href="../4.0.0/tutorial.html">4.0.0</a></dd>
      <dd><a href="../4.0.1/tutorial.html">4.0.1</a></dd>
      <dd><a href="../4.0.2/tutorial.html">4.0.2</a></dd>
      <dd><a href="../4.0.3/tutorial.html">4.0.3</a></dd>
      <dd><a href="../4.0.4/tutorial.html">4.0.4</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="../main/tutorial.html">main</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>