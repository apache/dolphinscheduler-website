{
  "__html": "<h1>Apache DolphinScheduler 2.0.3 发布，支持钉钉告警签名校验，数据源可从多个会话获取链接</h1>\n<div align=center>\n<img src=\"/img/2.0.3/2022-1-27/1.png\"/>\n</div>\n<blockquote>\n<p>今天，Apache DolphinScheduler 宣布 2.0.3 版本正式发布。本版本支持钉钉告警签名校验，以及数据源从多个会话获取链接。此外，2.0.3 还对缓存管理、补数时间、日志中的数据源密码显示等进行优化，并修复了若干关键 Bug。</p>\n</blockquote>\n<h2>新增功能</h2>\n<h3>钉钉告警支持加签名校验</h3>\n<p>2.0.3 支持通过签名方式实现钉钉机器人报警的功能。</p>\n<div align=center>\n<img src=\"/img/2.0.3/2022-1-27/2.png\"/>\n</div>\n<p>钉钉的参数配置</p>\n<ul>\n<li>Webhook</li>\n</ul>\n<p>格式如下：https://oapi.dingtalk.com/robot/send?access_token=XXXXXX</p>\n<ul>\n<li>Keyword</li>\n</ul>\n<p>安全设置的自定义关键词</p>\n<ul>\n<li>Secret</li>\n</ul>\n<p>安全设置的加签</p>\n<p>自定义机器人发送消息时，可以通过手机号码指定“被@人列表”。在“被@人列表”中的人员收到该消息时，会有@消息提醒。设置为免打扰模式，会话仍然会有通知提醒，在首屏出现“有人@你”提示。</p>\n<ul>\n<li>@Mobiles</li>\n</ul>\n<p>被@人的手机号</p>\n<ul>\n<li>@UserIds</li>\n</ul>\n<p>被@人的用户 userid</p>\n<ul>\n<li>@All</li>\n</ul>\n<p>是否@所有人</p>\n<h3>支持数据源从多个会话获取链接</h3>\n<p>此前，使用 JdbcDataSourceProvider.createOneSessionJdbcDataSource() 方法 hive/impala 创建连接池设置了 MaximumPoolSize=1，但是调度任务中，如果 hive/impala 多任务同时运行，会出现 getConnection=null 的情况，SqlTask.prepareStatementAndBind() 方法会抛出空指针异常。</p>\n<p>2.0.3 优化了这一点，支持数据源从多个会话获取链接。</p>\n<h2>优化</h2>\n<h3>缓存管理优化，减少 Master 调度过程中的 DB 查询次数</h3>\n<p>由于主服务器调度进程，中会出现大量的数据库读操作，如 tenant、user、processDefinition 等，这一方面会给 DB 带来巨大压力，另一方面会减慢整个核心调度过程。</p>\n<p>考虑到这部分业务数据是多读少写的场景，2.0.3 引入了缓存模块，主要作用于 Master 节点，将业务数据如租户、工作流定义等进行缓存，降低数据库查询压力，加快核心调度进程，详情可查看官网文档：https://dolphinscheduler.apache.org/en-us/docs/3.1.2/architecture/cache</p>\n<h3>补数时间区间从 “左闭右开” 改为 “左闭右闭”</h3>\n<p>此前，补数时间为“左闭右开”(startDate &lt;= N &lt; endDate)，不利于用户理解。优化之后，部署时间区间改为“左闭右闭”。</p>\n<h3>对日志中的数据源密码进行加密显示</h3>\n<p>数据源中的密码进行加密，加强隐私保护。</p>\n<h2>Bug 修复</h2>\n<ul>\n<li>zkRoot 配置不起作用</li>\n<li>修复修改管理员账号的用户信息引起的错误</li>\n<li>增加删除工作流定义同时删除工作流实例</li>\n<li>UDF 编辑文件夹对话框不能取消</li>\n<li>修复因为 netty 通讯没有失败重试，worker 和 master 通讯失败，导致工作流一直运行中的问题</li>\n<li>删除运行中的工作流，Master 会一直打印失败日志</li>\n<li>修复环境变量中选择 workerGroup 的问题</li>\n<li>修复依赖任务中告警设置不起作用的问题</li>\n<li>工作流历史版本查询信息出错</li>\n<li>解决高并发下任务日志输出影响性能的问题</li>\n<li>sub_process 节点的全局参数未传递给关联的工作流任务</li>\n<li>K8S 上 Master 任务登录时，查询日志无法显示内容</li>\n<li>进程定义列表中存在重复进程</li>\n<li>当流程实例 FailureStrategy.END 时任务失败，流程实例一直在运行</li>\n<li>t_ds_resources 表中的“is_directory”字段在 PostgreSQL 数据库中出现类型错误</li>\n<li>修复 Oracle 的 JDBC 连接</li>\n<li>Dag 中有禁止节点时，执行流程异常</li>\n<li>querySimpleList 返回错误的项目代码</li>\n</ul>\n<p><strong>Release Note:</strong> https://github.com/apache/dolphinscheduler/releases/tag/2.0.3</p>\n<p><strong>下载地址：</strong> https://dolphinscheduler.apache.org/zh-cn/download</p>\n<h2>感谢贡献者</h2>\n<p>感谢社区 Contributor 对本版本的积极贡献，以下为 Contributor 名单，排名不分先后：</p>\n<div align=center>\n<img src=\"/img/2.0.3/2022-1-27/3.png\"/>\n</div>\n",
  "time": "2022-1-27",
  "author": "Debra Chen",
  "title": "Apache DolphinScheduler 2.0.3 发布，支持钉钉告警签名校验，数据源可从多个会话获取链接",
  "type": "release",
  "label": "版本发布"
}