{
  "__html": "<h1 id=\"dolphinscheduler-升级\">DolphinScheduler 升级</h1>\n<h2 id=\"准备工作\">准备工作</h2>\n<h3 id=\"检查不向前兼容的更改\">检查不向前兼容的更改</h3>\n<p>在升级之前，您应该检查 <a href=\"/zh-cn/docs/3.1.7/guide/upgrade/incompatible\">incompatible change</a>，因为一些不兼容的更改可能会破坏您当前的功能。</p>\n<h3 id=\"备份上一版本文件和数据库\">备份上一版本文件和数据库</h3>\n<p>为了防止操作错误导致数据丢失，建议升级之前备份数据，备份方法请结合你数据库的情况来定</p>\n<h3 id=\"下载新版本的安装包\">下载新版本的安装包</h3>\n<p>在<a href=\"/zh-cn/download/download.html\">下载</a>页面下载最新版本的二进制安装包，并将二进制包放到与当前 dolphinscheduler 服务不一样的路径中，以下升级操作都需要在新版本的目录进行。</p>\n<h2 id=\"升级步骤\">升级步骤</h2>\n<h3 id=\"停止-dolphinscheduler-所有服务\">停止 dolphinscheduler 所有服务</h3>\n<p>根据你部署方式停止 dolphinscheduler 的所有服务，如果你是通过 <a href=\"../installation//zh-cn/docs/3.1.7/guide/installation/cluster\">集群部署</a> 来部署你的 dolphinscheduler 的话，可以通过 <code>sh ./script/stop-all.sh</code> 停止全部服务。</p>\n<h3 id=\"数据库升级\">数据库升级</h3>\n<p>修改 <code>./bin/env/dolphinscheduler_env.sh</code> 中的如下配置（{user}和{password}改成你数据库的用户名和密码），然后运行升级脚本。</p>\n<p>下面以 MySQL 为例，别的数据库仅需要修改成对应的配置即可。请先手动下载 <a href=\"https://downloads.MySQL.com/archives/c-j/\">mysql-connector-java 驱动 jar</a>\njar 包 并添加到 <code>./tools/libs</code> 目录下，修改 <code>./bin/env/dolphinscheduler_env.sh</code> 文件</p>\n<pre><code>    ```shell\n    export DATABASE=${DATABASE:-mysql}\n    export SPRING_PROFILES_ACTIVE=${DATABASE}\n    export SPRING_DATASOURCE_URL=&quot;jdbc:mysql://127.0.0.1:3306/dolphinscheduler?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&quot;\n    export SPRING_DATASOURCE_USERNAME={user}\n    export SPRING_DATASOURCE_PASSWORD={password}\n    ```\n</code></pre>\n<p>执行数据库升级脚本：<code>sh ./tools/bin/upgrade-schema.sh</code></p>\n<h3 id=\"服务升级\">服务升级</h3>\n<h4 id=\"修改-<code>bin/env/install_config.conf</code>-配置内容\">修改 <code>bin/env/install_config.conf</code> 配置内容</h4>\n<ul>\n<li>伪集群部署请参照<a href=\"../installation//zh-cn/docs/3.1.7/guide/installation/pseudo-cluster\">伪集群部署(Pseudo-Cluster)</a>中的 <code>修改相关配置</code></li>\n<li>集群部署请参照<a href=\"../installation//zh-cn/docs/3.1.7/guide/installation/cluster\">集群部署(Cluster)</a>中的 <code>修改相关配置</code></li>\n</ul>\n<p>然后运行命令 <code>sh ./bin/start-all.sh</code> 重启全部服务。</p>\n<h2 id=\"注意事项\">注意事项</h2>\n<h3 id=\"worker-分组的区别（以-1.3.1-版本为界）\">worker 分组的区别（以 1.3.1 版本为界）</h3>\n<p>创建worker分组在1.3.1版本之前，与 1.3.1之后到 2.0.0 之间的版本有不同的设计：</p>\n<ul>\n<li>worker分组在1.3.1版本之前是通过UI界面创建</li>\n<li>worker分组在1.3.1 到 2.0.0之前的版本是修改 worker 配置指定</li>\n</ul>\n<h4 id=\"面对这种区别我应该怎么升级\">面对这种区别我应该怎么升级</h4>\n<p>1.3.1之前的版本升级1.3.2时如何设置worker分组与之前一致</p>\n<ul>\n<li>查询已备份的数据库，查看 <code>t_ds_worker_group</code> 表记录，重点看下id、name和ip_list三个字段</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">id</th>\n<th style=\"text-align:center\">name</th>\n<th style=\"text-align:right\">ip_list</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">1</td>\n<td style=\"text-align:center\">service1</td>\n<td style=\"text-align:right\">192.168.xx.10</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">2</td>\n<td style=\"text-align:center\">service2</td>\n<td style=\"text-align:right\">192.168.xx.11,192.168.xx.12</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>修改 <code>bin/env/install_config.conf</code> 中的 workers 参数</li>\n</ul>\n<p>假设以下为要部署的worker主机名和ip的对应关系</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">主机名</th>\n<th style=\"text-align:center\">ip</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">ds1</td>\n<td style=\"text-align:center\">192.168.xx.10</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ds2</td>\n<td style=\"text-align:center\">192.168.xx.11</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ds3</td>\n<td style=\"text-align:center\">192.168.xx.12</td>\n</tr>\n</tbody>\n</table>\n<p>那么为了保持与之前版本worker分组一致，则需要把workers参数改为如下</p>\n<pre><code class=\"language-sh\"><span class=\"hljs-comment\"># worker服务部署在哪台机器上,并指定此worker属于哪一个worker组</span>\nworkers=<span class=\"hljs-string\">&quot;ds1:service1,ds2:service2,ds3:service2&quot;</span>\n</code></pre>\n<h4 id=\"1.3.2及以后的版本对-worker-分组功能进行增强\">1.3.2及以后的版本对 worker 分组功能进行增强</h4>\n<p>1.3.1 以及之前的版本worker不能同时属于多个worker分组，1.3.2及之后，2.0.0之前的版本是可以支持的，所以可以使用如下配置对一台worker配置多个分组</p>\n<pre><code class=\"language-sh\">workers=<span class=\"hljs-string\">&quot;ds1:service1,ds1:service2&quot;</span>\n</code></pre>\n<h4 id=\"在-2.0.0-版本之后恢复-ui-创建-worker-group\">在 2.0.0 版本之后恢复 UI 创建 worker group</h4>\n<p>在 2.0.0 以及之后的版本，我们恢复了在 UI 创建 worker group 的功能。</p>\n",
  "location": [
    "功能介绍",
    "升级",
    "升级步骤"
  ],
  "time": "2023-05-25",
  "structure": [
    {
      "title": "准备工作",
      "children": [
        {
          "title": "检查不向前兼容的更改",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "检查不向前兼容的更改"
        },
        {
          "title": "备份上一版本文件和数据库",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "备份上一版本文件和数据库"
        },
        {
          "title": "下载新版本的安装包",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "下载新版本的安装包"
        },
        {
          "title": "停止 dolphinscheduler 所有服务",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "停止-dolphinscheduler-所有服务"
        },
        {
          "title": "数据库升级",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "数据库升级"
        },
        {
          "title": "服务升级",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "服务升级"
        },
        {
          "title": "worker 分组的区别（以 1.3.1 版本为界）",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "worker-分组的区别（以-1.3.1-版本为界）"
        }
      ],
      "anchor": "准备工作"
    },
    {
      "title": "升级步骤",
      "children": [
        {
          "title": "检查不向前兼容的更改",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "检查不向前兼容的更改"
        },
        {
          "title": "备份上一版本文件和数据库",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "备份上一版本文件和数据库"
        },
        {
          "title": "下载新版本的安装包",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "下载新版本的安装包"
        },
        {
          "title": "停止 dolphinscheduler 所有服务",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "停止-dolphinscheduler-所有服务"
        },
        {
          "title": "数据库升级",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "数据库升级"
        },
        {
          "title": "服务升级",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "服务升级"
        },
        {
          "title": "worker 分组的区别（以 1.3.1 版本为界）",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "worker-分组的区别（以-1.3.1-版本为界）"
        }
      ],
      "anchor": "升级步骤"
    },
    {
      "title": "注意事项",
      "children": [
        {
          "title": "检查不向前兼容的更改",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "检查不向前兼容的更改"
        },
        {
          "title": "备份上一版本文件和数据库",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "备份上一版本文件和数据库"
        },
        {
          "title": "下载新版本的安装包",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "下载新版本的安装包"
        },
        {
          "title": "停止 dolphinscheduler 所有服务",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "停止-dolphinscheduler-所有服务"
        },
        {
          "title": "数据库升级",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "数据库升级"
        },
        {
          "title": "服务升级",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "服务升级"
        },
        {
          "title": "worker 分组的区别（以 1.3.1 版本为界）",
          "children": [
            {
              "title": "修改 bin/env/install_config.conf 配置内容",
              "children": [],
              "anchor": "修改-bin/env/install_config.conf-配置内容"
            },
            {
              "title": "面对这种区别我应该怎么升级",
              "children": [],
              "anchor": "面对这种区别我应该怎么升级"
            },
            {
              "title": "1.3.2及以后的版本对 worker 分组功能进行增强",
              "children": [],
              "anchor": "1.3.2及以后的版本对-worker-分组功能进行增强"
            },
            {
              "title": "在 2.0.0 版本之后恢复 UI 创建 worker group",
              "children": [],
              "anchor": "在-2.0.0-版本之后恢复-ui-创建-worker-group"
            }
          ],
          "anchor": "worker-分组的区别（以-1.3.1-版本为界）"
        }
      ],
      "anchor": "注意事项"
    }
  ],
  "title": "DolphinScheduler 升级",
  "link": "/guide/upgrade/upgrade"
}