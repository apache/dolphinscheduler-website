{
  "__html": "<h1 id=\"资源中心配置详情\">资源中心配置详情</h1>\n<ul>\n<li>资源中心通常用于上传文件、UDF 函数，以及任务组管理等操作。</li>\n<li>资源中心可以对接分布式的文件存储系统，如<a href=\"https://hadoop.apache.org/docs/r2.7.0/\">Hadoop</a>（2.6+）或者<a href=\"https://github.com/minio/minio\">MinIO</a>集群，也可以对接远端的对象存储，如<a href=\"https://aws.amazon.com/s3/\">AWS S3</a>或者<a href=\"https://www.aliyun.com/product/oss\">阿里云 OSS</a>等。</li>\n<li>资源中心也可以直接对接本地文件系统。在单机模式下，您无需依赖<code>Hadoop</code>或<code>S3</code>一类的外部存储系统，可以方便地对接本地文件系统进行体验。</li>\n<li>除此之外，对于集群模式下的部署，您可以通过使用<a href=\"https://github.com/s3fs-fuse/s3fs-fuse\">S3FS-FUSE</a>将<code>S3</code>挂载到本地，或者使用<a href=\"https://help.aliyun.com/document_detail/187410.html\">JINDO-FUSE</a>将<code>OSS</code>挂载到本地等，再用资源中心对接本地文件系统方式来操作远端对象存储中的文件。</li>\n</ul>\n<h2 id=\"对接本地文件系统\">对接本地文件系统</h2>\n<h3 id=\"配置-<code>common.properties</code>-文件\">配置 <code>common.properties</code> 文件</h3>\n<ul>\n<li>如果您以 <code>集群</code> 模式或者 <code>伪集群</code> 模式部署DolphinScheduler，您需要对以下路径的文件进行配置：<code>api-server/conf/common.properties</code> 和 <code>worker-server/conf/common.properties</code>；</li>\n<li>若您以 <code>单机</code> 模式部署DolphinScheduler，您只需要配置 <code>standalone-server/conf/common.properties</code>，具体配置如下：</li>\n</ul>\n<p>如下配置三个字段</p>\n<pre><code class=\"language-properties\"><span class=\"hljs-attr\">......</span>\n<span class=\"hljs-comment\">\n# resource storage type: HDFS, S3, NONE</span>\n<span class=\"hljs-attr\">resource.storage.type</span>=<span class=\"hljs-string\">HDFS</span>\n<span class=\"hljs-comment\"># resource store on HDFS/S3 path, resource file will store to this base path, self configuration, please make sure the directory exists on hdfs and have read write permissions. &quot;/dolphinscheduler&quot; is recommended</span>\n<span class=\"hljs-attr\">resource.storage.upload.base.path</span>=<span class=\"hljs-string\">/tmp/dolphinscheduler</span>\n\n<span class=\"hljs-attr\">......</span>\n\n<span class=\"hljs-attr\">resource.hdfs.fs.defaultFS</span>=<span class=\"hljs-string\">file:///</span>\n\n<span class=\"hljs-attr\">......</span>\n\n</code></pre>\n<ul>\n<li>将 <code>resource.storage.upload.base.path</code> 改为本地存储路径，请确保部署 DolphinScheduler 的用户拥有读写权限，例如：<code>resource.storage.upload.base.path=/tmp/dolphinscheduler</code>。当路径不存在时会自动创建文件夹</li>\n<li>修改 <code>resource.storage.type=HDFS</code> 和 <code>resource.hdfs.fs.defaultFS=file:///</code>。</li>\n</ul>\n<blockquote>\n<p><strong>注意</strong>：如果您不想用默认值作为资源中心的基础路径，请修改<code>resource.storage.upload.base.path</code>的值。</p>\n</blockquote>\n<h2 id=\"对接分布式或远端对象存储\">对接分布式或远端对象存储</h2>\n<p>当需要使用资源中心进行相关文件的创建或者上传操作时，所有的文件和资源都会被存储在分布式文件系统<code>HDFS</code>或者远端的对象存储，如<code>S3</code>上。所以需要进行以下配置：</p>\n<h3 id=\"配置-common.properties-文件\">配置 common.properties 文件</h3>\n<p>在 3.0.0-alpha 版本之后，如果需要使用到资源中心的 HDFS 或 S3 上传资源，我们需要对以下路径的进行配置：<code>api-server/conf/common.properties</code> 和 <code>worker-server/conf/common.properties</code>。可参考如下：</p>\n<pre><code class=\"language-properties\"><span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># Licensed to the Apache Software Foundation (ASF) under one or more</span>\n<span class=\"hljs-comment\"># contributor license agreements.  See the NOTICE file distributed with</span>\n<span class=\"hljs-comment\"># this work for additional information regarding copyright ownership.</span>\n<span class=\"hljs-comment\"># The ASF licenses this file to You under the Apache License, Version 2.0</span>\n<span class=\"hljs-comment\"># (the &quot;License&quot;); you may not use this file except in compliance with</span>\n<span class=\"hljs-comment\"># the License.  You may obtain a copy of the License at</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\">#     http://www.apache.org/licenses/LICENSE-2.0</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># Unless required by applicable law or agreed to in writing, software</span>\n<span class=\"hljs-comment\"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>\n<span class=\"hljs-comment\"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>\n<span class=\"hljs-comment\"># See the License for the specific language governing permissions and</span>\n<span class=\"hljs-comment\"># limitations under the License.</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\">\n# user data local directory path, please make sure the directory exists and have read write permissions</span>\n<span class=\"hljs-attr\">data.basedir.path</span>=<span class=\"hljs-string\">/tmp/dolphinscheduler</span>\n<span class=\"hljs-comment\">\n# resource storage type: HDFS, S3, OSS, NONE</span>\n<span class=\"hljs-attr\">resource.storage.type</span>=<span class=\"hljs-string\">HDFS</span>\n<span class=\"hljs-comment\">\n# resource store on HDFS/S3/OSS path, resource file will store to this hadoop hdfs path, self configuration,</span>\n<span class=\"hljs-comment\"># please make sure the directory exists on hdfs and have read write permissions. &quot;/dolphinscheduler&quot; is recommended</span>\n<span class=\"hljs-attr\">resource.storage.upload.base.path</span>=<span class=\"hljs-string\">/tmp/dolphinscheduler</span>\n<span class=\"hljs-comment\">\n# The AWS access key. if resource.storage.type=S3 or use EMR-Task, This configuration is required</span>\n<span class=\"hljs-attr\">resource.aws.access.key.id</span>=<span class=\"hljs-string\">minioadmin</span>\n<span class=\"hljs-comment\"># The AWS secret access key. if resource.storage.type=S3 or use EMR-Task, This configuration is required</span>\n<span class=\"hljs-attr\">resource.aws.secret.access.key</span>=<span class=\"hljs-string\">minioadmin</span>\n<span class=\"hljs-comment\"># The AWS Region to use. if resource.storage.type=S3 or use EMR-Task, This configuration is required</span>\n<span class=\"hljs-attr\">resource.aws.region</span>=<span class=\"hljs-string\">cn-north-1</span>\n<span class=\"hljs-comment\"># The name of the bucket. You need to create them by yourself. Otherwise, the system cannot start. All buckets in Amazon S3 share a single namespace; ensure the bucket is given a unique name.</span>\n<span class=\"hljs-attr\">resource.aws.s3.bucket.name</span>=<span class=\"hljs-string\">dolphinscheduler</span>\n<span class=\"hljs-comment\"># You need to set this parameter when private cloud s3. If S3 uses public cloud, you only need to set resource.aws.region or set to the endpoint of a public cloud such as S3.cn-north-1.amazonaws.com.cn</span>\n<span class=\"hljs-attr\">resource.aws.s3.endpoint</span>=<span class=\"hljs-string\">http://localhost:9000</span>\n<span class=\"hljs-comment\">\n# alibaba cloud access key id, required if you set resource.storage.type=OSS </span>\n<span class=\"hljs-attr\">resource.alibaba.cloud.access.key.id</span>=<span class=\"hljs-string\">&lt;your-access-key-id&gt;</span>\n<span class=\"hljs-comment\"># alibaba cloud access key secret, required if you set resource.storage.type=OSS</span>\n<span class=\"hljs-attr\">resource.alibaba.cloud.access.key.secret</span>=<span class=\"hljs-string\">&lt;your-access-key-secret&gt;</span>\n<span class=\"hljs-comment\"># alibaba cloud region, required if you set resource.storage.type=OSS</span>\n<span class=\"hljs-attr\">resource.alibaba.cloud.region</span>=<span class=\"hljs-string\">cn-hangzhou</span>\n<span class=\"hljs-comment\"># oss bucket name, required if you set resource.storage.type=OSS</span>\n<span class=\"hljs-attr\">resource.alibaba.cloud.oss.bucket.name</span>=<span class=\"hljs-string\">dolphinscheduler</span>\n<span class=\"hljs-comment\"># oss bucket endpoint, required if you set resource.storage.type=OSS</span>\n<span class=\"hljs-attr\">resource.alibaba.cloud.oss.endpoint</span>=<span class=\"hljs-string\">https://oss-cn-hangzhou.aliyuncs.com</span>\n<span class=\"hljs-comment\">\n# if resource.storage.type=HDFS, the user must have the permission to create directories under the HDFS root path</span>\n<span class=\"hljs-attr\">resource.hdfs.root.user</span>=<span class=\"hljs-string\">root</span>\n<span class=\"hljs-comment\"># if resource.storage.type=S3, the value like: s3a://dolphinscheduler;</span>\n<span class=\"hljs-comment\"># if resource.storage.type=HDFS and namenode HA is enabled, you need to copy core-site.xml and hdfs-site.xml to conf dir</span>\n<span class=\"hljs-attr\">resource.hdfs.fs.defaultFS</span>=<span class=\"hljs-string\">hdfs://localhost:8020</span>\n<span class=\"hljs-comment\">\n# whether to startup kerberos</span>\n<span class=\"hljs-attr\">hadoop.security.authentication.startup.state</span>=<span class=\"hljs-string\">false</span>\n<span class=\"hljs-comment\">\n# java.security.krb5.conf path</span>\n<span class=\"hljs-attr\">java.security.krb5.conf.path</span>=<span class=\"hljs-string\">/opt/krb5.conf</span>\n<span class=\"hljs-comment\">\n# login user from keytab username</span>\n<span class=\"hljs-attr\">login.user.keytab.username</span>=<span class=\"hljs-string\">hdfs-mycluster@ESZ.COM</span>\n<span class=\"hljs-comment\">\n# login user from keytab path</span>\n<span class=\"hljs-attr\">login.user.keytab.path</span>=<span class=\"hljs-string\">/opt/hdfs.headless.keytab</span>\n<span class=\"hljs-comment\">\n# kerberos expire time, the unit is hour</span>\n<span class=\"hljs-attr\">kerberos.expire.time</span>=<span class=\"hljs-string\">2</span>\n<span class=\"hljs-comment\"># resource view suffixs</span>\n<span class=\"hljs-comment\">#resource.view.suffixs=txt,log,sh,bat,conf,cfg,py,java,sql,xml,hql,properties,json,yml,yaml,ini,js</span>\n<span class=\"hljs-comment\">\n# resourcemanager port, the default value is 8088 if not specified</span>\n<span class=\"hljs-attr\">resource.manager.httpaddress.port</span>=<span class=\"hljs-string\">8088</span>\n<span class=\"hljs-comment\"># if resourcemanager HA is enabled, please set the HA IPs; if resourcemanager is single, keep this value empty</span>\n<span class=\"hljs-attr\">yarn.resourcemanager.ha.rm.ids</span>=<span class=\"hljs-string\">192.168.xx.xx,192.168.xx.xx</span>\n<span class=\"hljs-comment\"># if resourcemanager HA is enabled or not use resourcemanager, please keep the default value;</span>\n<span class=\"hljs-comment\"># If resourcemanager is single, you only need to replace ds1 to actual resourcemanager hostname</span>\n<span class=\"hljs-attr\">yarn.application.status.address</span>=<span class=\"hljs-string\">http://localhost:%s/ds/v1/cluster/apps/%s</span>\n<span class=\"hljs-comment\"># job history status url when application number threshold is reached(default 10000, maybe it was set to 1000)</span>\n<span class=\"hljs-attr\">yarn.job.history.status.address</span>=<span class=\"hljs-string\">http://localhost:19888/ds/v1/history/mapreduce/jobs/%s</span>\n<span class=\"hljs-comment\">\n# datasource encryption enable</span>\n<span class=\"hljs-attr\">datasource.encryption.enable</span>=<span class=\"hljs-string\">false</span>\n<span class=\"hljs-comment\">\n# datasource encryption salt</span>\n<span class=\"hljs-attr\">datasource.encryption.salt</span>=<span class=\"hljs-string\">!@#$%^&amp;*</span>\n<span class=\"hljs-comment\">\n# data quality option</span>\n<span class=\"hljs-attr\">data-quality.jar.name</span>=<span class=\"hljs-string\">dolphinscheduler-data-quality-dev-SNAPSHOT.jar</span>\n<span class=\"hljs-comment\">\n#data-quality.error.output.path=/tmp/data-quality-error-data</span>\n<span class=\"hljs-comment\">\n# Network IP gets priority, default inner outer</span>\n<span class=\"hljs-comment\">\n# Whether hive SQL is executed in the same session</span>\n<span class=\"hljs-attr\">support.hive.oneSession</span>=<span class=\"hljs-string\">false</span>\n<span class=\"hljs-comment\">\n# use sudo or not, if set true, executing user is tenant user and deploy user needs sudo permissions;</span>\n<span class=\"hljs-comment\"># if set false, executing user is the deploy user and doesn&#x27;t need sudo permissions</span>\n<span class=\"hljs-attr\">sudo.enable</span>=<span class=\"hljs-string\">true</span>\n<span class=\"hljs-comment\">\n# network interface preferred like eth0, default: empty</span>\n<span class=\"hljs-comment\">#dolphin.scheduler.network.interface.preferred=</span>\n<span class=\"hljs-comment\">\n# network IP gets priority, default: inner outer</span>\n<span class=\"hljs-comment\">#dolphin.scheduler.network.priority.strategy=default</span>\n<span class=\"hljs-comment\">\n# system env path</span>\n<span class=\"hljs-comment\">#dolphinscheduler.env.path=env/dolphinscheduler_env.sh</span>\n<span class=\"hljs-comment\">\n# development state</span>\n<span class=\"hljs-attr\">development.state</span>=<span class=\"hljs-string\">false</span>\n<span class=\"hljs-comment\">\n# rpc port</span>\n<span class=\"hljs-attr\">alert.rpc.port</span>=<span class=\"hljs-string\">50052</span>\n</code></pre>\n<blockquote>\n<p><strong>注意</strong>：</p>\n<ul>\n<li>如果只配置了 <code>api-server/conf/common.properties</code> 的文件，则只是开启了资源上传的操作，并不能满足正常使用。如果想要在工作流中执行相关文件则需要额外配置 <code>worker-server/conf/common.properties</code>。</li>\n<li>如果用到资源上传的功能，那么<a href=\"../installation//zh-cn/docs/3.1.7/guide/installation/standalone\">安装部署</a>中，部署用户需要有这部分的操作权限。</li>\n<li>如果 Hadoop 集群的 NameNode 配置了 HA 的话，需要开启 HDFS 类型的资源上传，同时需要将 Hadoop 集群下的 <code>core-site.xml</code> 和 <code>hdfs-site.xml</code> 复制到 <code>worker-server/conf</code> 以及 <code>api-server/conf</code>，非 NameNode HA 跳过次步骤。</li>\n</ul>\n</blockquote>\n",
  "location": [
    "功能介绍",
    "资源中心",
    "配置详情"
  ],
  "time": "2023-05-25",
  "structure": [
    {
      "title": "对接本地文件系统",
      "children": [
        {
          "title": "配置 common.properties 文件",
          "children": [],
          "anchor": "配置-common.properties-文件"
        },
        {
          "title": "配置 common.properties 文件",
          "children": [],
          "anchor": "配置-common.properties-文件"
        }
      ],
      "anchor": "对接本地文件系统"
    },
    {
      "title": "对接分布式或远端对象存储",
      "children": [
        {
          "title": "配置 common.properties 文件",
          "children": [],
          "anchor": "配置-common.properties-文件"
        },
        {
          "title": "配置 common.properties 文件",
          "children": [],
          "anchor": "配置-common.properties-文件"
        }
      ],
      "anchor": "对接分布式或远端对象存储"
    }
  ],
  "title": "资源中心配置详情",
  "link": "/guide/resource/configuration"
}