{
  "__html": "<h1 id=\"mlflow-node\">MLflow Node</h1>\n<h2 id=\"overview\">Overview</h2>\n<p><a href=\"https://mlflow.org\">MLflow</a> is an excellent open source platform to manage the ML lifecycle, including experimentation,\nreproducibility, deployment, and a central model registry.</p>\n<p>MLflow task plugin used to execute MLflow tasks，Currently contains MLflow Projects and MLflow Models. (Model Registry will soon be rewarded for support)</p>\n<ul>\n<li>MLflow Projects: Package data science code in a format to reproduce runs on any platform.</li>\n<li>MLflow Models: Deploy machine learning models in diverse serving environments.</li>\n<li>Model Registry: Store, annotate, discover, and manage models in a central repository.</li>\n</ul>\n<p>The MLflow plugin currently supports and will support the following:</p>\n<ul>\n<li>MLflow Projects\n<ul>\n<li>BasicAlgorithm: contains LogisticRegression, svm, lightgbm, xgboost</li>\n<li>AutoML: AutoML tool, contains autosklean, flaml</li>\n<li>Custom projects: Support for running your own MLflow projects</li>\n</ul>\n</li>\n<li>MLflow Models\n<ul>\n<li>MLFLOW: Use <code>MLflow models serve</code> to deploy a model service</li>\n<li>Docker: Run the container after packaging the docker image</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"create-task\">Create Task</h2>\n<ul>\n<li>Click <code>Project Management -&gt; Project Name -&gt; Workflow Definition</code>, and click the <code>Create Workflow</code> button to enter the DAG editing page.</li>\n<li>Drag from the toolbar <img src=\"/img/tasks/icons/mlflow.png\" width=\"15\"/> task node to canvas.</li>\n</ul>\n<h2 id=\"task-parameters-and-example\">Task Parameters and Example</h2>\n<ul>\n<li>Please refer to <a href=\"/en-us/docs/3.1.9/guide/task/appendix\">DolphinScheduler Task Parameters Appendix</a> <code>Default Task Parameters</code> section for default parameters.</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th><strong>Parameter</strong></th>\n<th><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>MLflow Tracking Server URI</td>\n<td>MLflow Tracking Server URI, default http://localhost:5000.</td>\n</tr>\n<tr>\n<td>Experiment Name</td>\n<td>Create the experiment where the task is running, if the experiment does not exist. If the name is empty, it is set to <code>Default</code>, the same as MLflow.</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"mlflow-projects\">MLflow Projects</h3>\n<h4 id=\"basicalgorithm\">BasicAlgorithm</h4>\n<p><img src=\"/img/tasks/demo/mlflow-basic-algorithm.png\" alt=\"mlflow-conda-env\"></p>\n<p><strong>Task Parameters</strong></p>\n<table>\n<thead>\n<tr>\n<th><strong>Parameter</strong></th>\n<th><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Register Model</td>\n<td>Register the model or not. If register is selected, the following parameters are expanded.</td>\n</tr>\n<tr>\n<td>Model Name</td>\n<td>The registered model name is added to the original model version and registered as Production.</td>\n</tr>\n<tr>\n<td>Data Path</td>\n<td>The absolute path of the file or folder. Ends with .csv for file or contain train.csv and test.csv for folder（In the suggested way, users should build their own test sets for model evaluation.</td>\n</tr>\n<tr>\n<td>Parameters</td>\n<td>Parameter when initializing the algorithm/AutoML model, which can be empty. For example, parameters <code>&quot;time_budget=30;estimator_list=['lgbm']&quot;</code> for flaml. The convention will be passed with '; ' shards each parameter, using the name before the equal sign as the parameter name, and using the name after the equal sign to get the corresponding parameter value through <code>python eval()</code>. <ul><li><a href=\"https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression\">Logistic Regression</a></li><li><a href=\"https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html?highlight=svc#sklearn.svm.SVC\">SVM</a></li><li><a href=\"https://lightgbm.readthedocs.io/en/latest/pythonapi/lightgbm.LGBMClassifier.html#lightgbm.LGBMClassifier\">lightgbm</a></li><li><a href=\"https://xgboost.readthedocs.io/en/stable/python/python_api.html#xgboost.XGBClassifier\">xgboost</a></li></ul></td>\n</tr>\n<tr>\n<td>Algorithm</td>\n<td>The selected algorithm currently supports <code>LR</code>, <code>SVM</code>, <code>LightGBM</code> and <code>XGboost</code> based on <a href=\"https://scikit-learn.org/\">scikit-learn</a> form.</td>\n</tr>\n<tr>\n<td>Parameter Search Space</td>\n<td>Parameter search space when running the corresponding algorithm, which can be empty. For example, the parameter <code>max_depth=[5, 10];n_estimators=[100, 200]</code> for lightgbm. The convention will be passed with '; 'shards each parameter, using the name before the equal sign as the parameter name, and using the name after the equal sign to get the corresponding parameter value through <code>python eval()</code>.</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"automl\">AutoML</h4>\n<p><img src=\"/img/tasks/demo/mlflow-automl.png\" alt=\"mlflow-automl\"></p>\n<p><strong>Task Parameter</strong></p>\n<table>\n<thead>\n<tr>\n<th><strong>Parameter</strong></th>\n<th><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Register Model</td>\n<td>Register the model or not. If register is selected, the following parameters are expanded.</td>\n</tr>\n<tr>\n<td>model name</td>\n<td>The registered model name is added to the original model version and registered as Production.</td>\n</tr>\n<tr>\n<td>Data Path</td>\n<td>The absolute path of the file or folder. Ends with .csv for file or contain train.csv and test.csv for folder(In the suggested way, users should build their own test sets for model evaluation).</td>\n</tr>\n<tr>\n<td>Parameters</td>\n<td>Parameter when initializing the algorithm/AutoML model, which can be empty. For example, parameters <code>n_estimators=200;learning_rate=0.2</code> for flaml. The convention will be passed with '; 'shards each parameter, using the name before the equal sign as the parameter name, and using the name after the equal sign to get the corresponding parameter value through <code>python eval()</code>. The detailed parameter list is as follows: <ul><li><a href=\"https://microsoft.github.io/FLAML/docs/Use-Cases/Task-Oriented-AutoML\">flaml</a></li><li><a href=\"https://automl.github.io/auto-sklearn/master/api.html\">autosklearn</a></li></ul></td>\n</tr>\n<tr>\n<td>AutoML tool</td>\n<td>The AutoML tool used, currently supports <a href=\"https://github.com/automl/auto-sklearn\">autosklearn</a> and <a href=\"https://github.com/microsoft/FLAML\">flaml</a>.</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"custom-projects\">Custom projects</h4>\n<p><img src=\"/img/tasks/demo/mlflow-custom-project.png\" alt=\"mlflow-custom-project.png\"></p>\n<p><strong>Task Parameter</strong></p>\n<table>\n<thead>\n<tr>\n<th><strong>Parameter</strong></th>\n<th><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>parameters</td>\n<td><code>--param-list</code> in <code>mlflow run</code>. For example <code>-P learning_rate=0.2 -P colsample_bytree=0.8 -P subsample=0.9</code>.</td>\n</tr>\n<tr>\n<td>Repository</td>\n<td>Repository url of MLflow Project, Support git address and directory on worker. If it's in a subdirectory, We add <code>#</code> to support this (same as <code>mlflow run</code>) , for example <code>https://github.com/mlflow/mlflow#examples/xgboost/xgboost_native</code>.</td>\n</tr>\n<tr>\n<td>Project Version</td>\n<td>Version of the project, default master.</td>\n</tr>\n</tbody>\n</table>\n<p>You can now use this feature to run all MLFlow projects on Github (For example <a href=\"https://github.com/mlflow/mlflow/tree/master/examples\">MLflow examples</a> ). You can also create your own machine learning library to reuse your work, and then use DolphinScheduler to use your library with one click.</p>\n<h3 id=\"mlflow-models\">MLflow Models</h3>\n<p><strong>General Parameters</strong></p>\n<table>\n<thead>\n<tr>\n<th><strong>Parameter</strong></th>\n<th><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Model-URI</td>\n<td>Model-URI of MLflow , support <code>models:/&lt;model_name&gt;/suffix</code> format and <code>runs:/</code> format. See https://mlflow.org/docs/latest/tracking.html#artifact-stores</td>\n</tr>\n<tr>\n<td>Port</td>\n<td>The port to listen on.</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"mlflow\">MLflow</h4>\n<p><img src=\"/img/tasks/demo/mlflow-models-mlflow.png\" alt=\"mlflow-models-mlflow\"></p>\n<h4 id=\"docker\">Docker</h4>\n<p><img src=\"/img/tasks/demo/mlflow-models-docker.png\" alt=\"mlflow-models-docker\"></p>\n<h2 id=\"environment-to-prepare\">Environment to Prepare</h2>\n<h3 id=\"conda-environment\">Conda Environment</h3>\n<p>Please install <a href=\"https://docs.continuum.io/anaconda/install/\">anaconda</a> or <a href=\"https://docs.conda.io/en/latest/miniconda.html#installing\">miniconda</a> in advance.</p>\n<p><strong>Method A:</strong></p>\n<p>Config anaconda environment in <code>/dolphinscheduler/conf/env/dolphinscheduler_env.sh</code>.</p>\n<p>Add the following content to the file:</p>\n<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># config anaconda environment</span>\n<span class=\"hljs-built_in\">export</span> PATH=/opt/anaconda3/bin:<span class=\"hljs-variable\">$PATH</span>\n</code></pre>\n<p><strong>Method B:</strong></p>\n<p>You need to enter the admin account to configure a conda environment variable.</p>\n<p><img src=\"/img/tasks/demo/mlflow-conda-env.png\" alt=\"mlflow-conda-env\"></p>\n<p>Note During the configuration task, select the conda environment created above. Otherwise, the program cannot find the\nConda environment.</p>\n<p><img src=\"/img/tasks/demo/mlflow-set-conda-env.png\" alt=\"mlflow-set-conda-env\"></p>\n<h3 id=\"start-the-mlflow-service\">Start the MLflow Service</h3>\n<p>Make sure you have installed MLflow, using 'pip install mlflow'.</p>\n<p>Create a folder where you want to save your experiments and models and start MLflow service.</p>\n<pre><code class=\"language-sh\"><span class=\"hljs-built_in\">mkdir</span> mlflow\n<span class=\"hljs-built_in\">cd</span> mlflow\nmlflow server -h 0.0.0.0 -p 5000 --serve-artifacts --backend-store-uri sqlite:///mlflow.db\n</code></pre>\n<p>After running, an MLflow service is started.</p>\n<p>After this, you can visit the MLflow service (<code>http://localhost:5000</code>) page to view the experiments and models.</p>\n<p><img src=\"/img/tasks/demo/mlflow-server.png\" alt=\"mlflow-server\"></p>\n<h3 id=\"preset-algorithm-repository-configuration\">Preset Algorithm Repository Configuration</h3>\n<p>If you can't access github, you can modify the following fields in the <code>commom.properties</code> configuration file to replace the github address with an accessible address.</p>\n<pre><code class=\"language-yaml\"><span class=\"hljs-comment\"># mlflow task plugin preset repository</span>\n<span class=\"hljs-string\">ml.mlflow.preset_repository=https://github.com/apache/dolphinscheduler-mlflow</span>\n<span class=\"hljs-comment\"># mlflow task plugin preset repository version</span>\n<span class=\"hljs-string\">ml.mlflow.preset_repository_version=&quot;main&quot;</span>\n</code></pre>\n",
  "location": [
    "Introduction to Functions",
    "Task",
    "MLflow"
  ],
  "time": "2023-12-25",
  "structure": [
    {
      "title": "Overview",
      "children": [
        {
          "title": "MLflow Projects",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "mlflow-projects"
        },
        {
          "title": "MLflow Models",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "mlflow-models"
        },
        {
          "title": "Conda Environment",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "conda-environment"
        },
        {
          "title": "Start the MLflow Service",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "start-the-mlflow-service"
        },
        {
          "title": "Preset Algorithm Repository Configuration",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "preset-algorithm-repository-configuration"
        }
      ],
      "anchor": "overview"
    },
    {
      "title": "Create Task",
      "children": [
        {
          "title": "MLflow Projects",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "mlflow-projects"
        },
        {
          "title": "MLflow Models",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "mlflow-models"
        },
        {
          "title": "Conda Environment",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "conda-environment"
        },
        {
          "title": "Start the MLflow Service",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "start-the-mlflow-service"
        },
        {
          "title": "Preset Algorithm Repository Configuration",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "preset-algorithm-repository-configuration"
        }
      ],
      "anchor": "create-task"
    },
    {
      "title": "Task Parameters and Example",
      "children": [
        {
          "title": "MLflow Projects",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "mlflow-projects"
        },
        {
          "title": "MLflow Models",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "mlflow-models"
        },
        {
          "title": "Conda Environment",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "conda-environment"
        },
        {
          "title": "Start the MLflow Service",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "start-the-mlflow-service"
        },
        {
          "title": "Preset Algorithm Repository Configuration",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "preset-algorithm-repository-configuration"
        }
      ],
      "anchor": "task-parameters-and-example"
    },
    {
      "title": "Environment to Prepare",
      "children": [
        {
          "title": "MLflow Projects",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "mlflow-projects"
        },
        {
          "title": "MLflow Models",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "mlflow-models"
        },
        {
          "title": "Conda Environment",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "conda-environment"
        },
        {
          "title": "Start the MLflow Service",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "start-the-mlflow-service"
        },
        {
          "title": "Preset Algorithm Repository Configuration",
          "children": [
            {
              "title": "BasicAlgorithm",
              "children": [],
              "anchor": "basicalgorithm"
            },
            {
              "title": "AutoML",
              "children": [],
              "anchor": "automl"
            },
            {
              "title": "Custom projects",
              "children": [],
              "anchor": "custom-projects"
            },
            {
              "title": "MLflow",
              "children": [],
              "anchor": "mlflow"
            },
            {
              "title": "Docker",
              "children": [],
              "anchor": "docker"
            }
          ],
          "anchor": "preset-algorithm-repository-configuration"
        }
      ],
      "anchor": "environment-to-prepare"
    }
  ],
  "title": "MLflow Node",
  "link": "/guide/task/mlflow"
}