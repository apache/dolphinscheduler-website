{
  "__html": "<h1 id=\"dolphinscheduler-upgrade\">DolphinScheduler Upgrade</h1>\n<h2 id=\"prepare\">Prepare</h2>\n<h3 id=\"backup-previous-version's-files-and-database\">Backup Previous Version's Files and Database</h3>\n<p>To prevent data loss by some miss-operation, it is recommended to back up data before upgrading. The backup way according to your environment.</p>\n<h3 id=\"download-the-latest-version-installation-package\">Download the Latest Version Installation Package</h3>\n<p>Download the latest binary distribute package from <a href=\"/en-us/download/download.html\">download</a> and then put it in the different\ndirectory where current service running. And all below command is running in this directory.</p>\n<h2 id=\"upgrade\">Upgrade</h2>\n<h3 id=\"stop-all-services-of-dolphinscheduler\">Stop All Services of DolphinScheduler</h3>\n<p>Stop all services of dolphinscheduler according to your deployment method. If you deploy your dolphinscheduler according to <a href=\".//en-us/docs/3.0.2/guide/installation/cluster\">cluster deployment</a>, you can stop all services by command <code>sh ./script/stop-all.sh</code>.</p>\n<h3 id=\"upgrade-database\">Upgrade Database</h3>\n<p>Change configuration in <code>./bin/env/dolphinscheduler_env.sh</code> ({user} and {password} are changed to your database username and password), and then run the upgrade script.</p>\n<p>Using MySQL as an example, change the value if you use other databases. Please manually download the <a href=\"https://downloads.MySQL.com/archives/c-j/\">mysql-connector-java driver jar</a>\njar package and add it to the <code>./tools/libs</code> directory, then change <code>./bin/ env/dolphinscheduler_env.sh</code> file</p>\n<pre><code>```shell\nexport DATABASE=${DATABASE:-mysql}\nexport SPRING_PROFILES_ACTIVE=${DATABASE}\nexport SPRING_DATASOURCE_URL=&quot;jdbc:mysql://127.0.0.1:3306/dolphinscheduler?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&quot;\nexport SPRING_DATASOURCE_USERNAME={user}\nexport SPRING_DATASOURCE_PASSWORD={password}\n```\n</code></pre>\n<p>Execute database upgrade script: <code>sh ./tools/bin/upgrade-schema.sh</code></p>\n<h3 id=\"upgrade-service\">Upgrade Service</h3>\n<h4 id=\"change-configuration-<code>bin/env/install_config.conf</code>\">Change Configuration <code>bin/env/install_config.conf</code></h4>\n<ul>\n<li>If you deploy with Pseudo-Cluster deployment, change it according to <a href=\".//en-us/docs/3.0.2/guide/installation/pseudo-cluster\">Pseudo-Cluster</a> section &quot;Modify Configuration&quot;.</li>\n<li>If you deploy with Cluster deployment, change it according to <a href=\".//en-us/docs/3.0.2/guide/installation/cluster\">Cluster</a> section &quot;Modify Configuration&quot;.</li>\n</ul>\n<p>And them run command <code>sh ./bin/start-all.sh</code> to start all services.</p>\n<h2 id=\"notice\">Notice</h2>\n<h3 id=\"differences-of-worker-group-(before-or-after-version-1.3.1-of-dolphinscheduler)\">Differences of worker group (before or after version 1.3.1 of dolphinscheduler)</h3>\n<p>The architecture of worker group is different between version before version 1.3.1 until version 2.0.0</p>\n<ul>\n<li>Before version 1.3.1(include itself) worker group can be created through UI interface.</li>\n<li>Since version 1.3.1 and before version 2.0.0, worker group can be created by modifying the worker configuration.</li>\n</ul>\n<h4 id=\"how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0\">How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0</h4>\n<ul>\n<li>Check the backup database, search records in table <code>t_ds_worker_group</code> table and mainly focus on three columns: <code>id, name and IP</code>.</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">id</th>\n<th style=\"text-align:center\">name</th>\n<th style=\"text-align:right\">ip_list</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">1</td>\n<td style=\"text-align:center\">service1</td>\n<td style=\"text-align:right\">192.168.xx.10</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">2</td>\n<td style=\"text-align:center\">service2</td>\n<td style=\"text-align:right\">192.168.xx.11,192.168.xx.12</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>Modify worker related configuration in <code>bin/env/install_config.conf</code>.</li>\n</ul>\n<p>Assume bellow are the machine worker service to be deployed:</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">hostname</th>\n<th style=\"text-align:center\">ip</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">ds1</td>\n<td style=\"text-align:center\">192.168.xx.10</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ds2</td>\n<td style=\"text-align:center\">192.168.xx.11</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ds3</td>\n<td style=\"text-align:center\">192.168.xx.12</td>\n</tr>\n</tbody>\n</table>\n<p>To keep worker group config consistent with the previous version, we need to modify workers configuration as below:</p>\n<pre><code class=\"language-shell\"><span class=\"hljs-meta prompt_\">#</span><span class=\"language-bash\">worker service is deployed on <span class=\"hljs-built_in\">which</span> machine, and also specify <span class=\"hljs-built_in\">which</span> worker group this worker belongs to.</span> \nworkers=&quot;ds1:service1,ds2:service2,ds3:service2&quot;\n</code></pre>\n<h4 id=\"the-worker-group-has-been-enhanced-in-version-1.3.2\">The Worker Group has Been Enhanced in Version 1.3.2</h4>\n<p>Workers in 1.3.1 can only belong to one worker group, but after version 1.3.2 and before version 2.0.0 worker support more than one worker group.</p>\n<pre><code class=\"language-sh\">workers=<span class=\"hljs-string\">&quot;ds1:service1,ds1:service2&quot;</span>\n</code></pre>\n<h4 id=\"recovery-ui-create-worker-group-after-version-2.0.0\">Recovery UI Create Worker Group after Version 2.0.0</h4>\n<p>After version 2.0.0, include itself, we are recovery function create worker group from web UI.</p>\n",
  "location": [
    "Introduction to Functions",
    "Upgrade"
  ],
  "time": "2022-11-21",
  "structure": [
    {
      "title": "Prepare",
      "children": [
        {
          "title": "Backup Previous Version's Files and Database",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "backup-previous-version's-files-and-database"
        },
        {
          "title": "Download the Latest Version Installation Package",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "download-the-latest-version-installation-package"
        },
        {
          "title": "Stop All Services of DolphinScheduler",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "stop-all-services-of-dolphinscheduler"
        },
        {
          "title": "Upgrade Database",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "upgrade-database"
        },
        {
          "title": "Upgrade Service",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "upgrade-service"
        },
        {
          "title": "Differences of worker group (before or after version 1.3.1 of dolphinscheduler)",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "differences-of-worker-group-(before-or-after-version-1.3.1-of-dolphinscheduler)"
        }
      ],
      "anchor": "prepare"
    },
    {
      "title": "Upgrade",
      "children": [
        {
          "title": "Backup Previous Version's Files and Database",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "backup-previous-version's-files-and-database"
        },
        {
          "title": "Download the Latest Version Installation Package",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "download-the-latest-version-installation-package"
        },
        {
          "title": "Stop All Services of DolphinScheduler",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "stop-all-services-of-dolphinscheduler"
        },
        {
          "title": "Upgrade Database",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "upgrade-database"
        },
        {
          "title": "Upgrade Service",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "upgrade-service"
        },
        {
          "title": "Differences of worker group (before or after version 1.3.1 of dolphinscheduler)",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "differences-of-worker-group-(before-or-after-version-1.3.1-of-dolphinscheduler)"
        }
      ],
      "anchor": "upgrade"
    },
    {
      "title": "Notice",
      "children": [
        {
          "title": "Backup Previous Version's Files and Database",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "backup-previous-version's-files-and-database"
        },
        {
          "title": "Download the Latest Version Installation Package",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "download-the-latest-version-installation-package"
        },
        {
          "title": "Stop All Services of DolphinScheduler",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "stop-all-services-of-dolphinscheduler"
        },
        {
          "title": "Upgrade Database",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "upgrade-database"
        },
        {
          "title": "Upgrade Service",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "upgrade-service"
        },
        {
          "title": "Differences of worker group (before or after version 1.3.1 of dolphinscheduler)",
          "children": [
            {
              "title": "Change Configuration bin/env/install_config.conf",
              "children": [],
              "anchor": "change-configuration-bin/env/install_config.conf"
            },
            {
              "title": "How Can I Do When I Upgrade from 1.3.1 to version before 2.0.0",
              "children": [],
              "anchor": "how-can-i-do-when-i-upgrade-from-1.3.1-to-version-before-2.0.0"
            },
            {
              "title": "The Worker Group has Been Enhanced in Version 1.3.2",
              "children": [],
              "anchor": "the-worker-group-has-been-enhanced-in-version-1.3.2"
            },
            {
              "title": "Recovery UI Create Worker Group after Version 2.0.0",
              "children": [],
              "anchor": "recovery-ui-create-worker-group-after-version-2.0.0"
            }
          ],
          "anchor": "differences-of-worker-group-(before-or-after-version-1.3.1-of-dolphinscheduler)"
        }
      ],
      "anchor": "notice"
    }
  ],
  "title": "DolphinScheduler Upgrade",
  "link": "/guide/upgrade"
}