{
  "__html": "<h1 id=\"sql\">SQL</h1>\n<h2 id=\"overview\">Overview</h2>\n<p>SQL task type used to connect to databases and execute SQL.</p>\n<h2 id=\"create_datasource\">Create DataSource</h2>\n<p>Refer to <a href=\"https://github.com/apache/dolphinscheduler/blob/3.1.0-release/docs/docs/en/guide/howto/datasource-setting.md\">datasource-setting</a> <code>DataSource Center</code> section</p>\n<h2 id=\"create_task\">Create Task</h2>\n<ul>\n<li>Click <code>Project Management -&gt; Project Name -&gt; Workflow Definition</code>, and click the <code>Create Workflow</code> button to enter the DAG editing page.</li>\n<li>Drag from the toolbar <img src=\"/img/tasks/icons/sql.png\" width=\"25\"/> to the canvas.</li>\n</ul>\n<h2 id=\"task_parameter\">Task Parameter</h2>\n<ul>\n<li>Please refer to <a href=\"/en-us/docs/3.1.0/guide/task/appendix#default-task-parameters\">DolphinScheduler Task Parameters Appendix</a> for default parameters.</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th><strong>Parameter</strong></th>\n<th><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Data source</td>\n<td>Select the corresponding DataSource.</td>\n</tr>\n<tr>\n<td>SQL type</td>\n<td>Supports query and non-query. <ul><li>Query: supports <code>DML select</code> type commands, which return a result set. You can specify three templates for email notification as form, attachment or form attachment;</li><li>Non-query: support <code>DDL</code> all commands and <code>DML update, delete, insert</code> three types of commands;<ul><li>Segmented execution symbol: When the data source does not support executing multiple SQL statements at a time, the symbol for splitting SQL statements is provided to call the data source execution method multiple times. Example: 1. When the Hive data source is selected as the data source, please do not use <code>;\\n</code> due to Hive JDBC does not support executing multiple SQL statements at one time; 2. When the MySQL data source is selected as the data source, and multi-segment SQL statements are to be executed, this parameter needs to be filled in with a semicolon `;. Because the MySQL data source does not support executing multiple SQL statements at one time.</li></ul></li></ul></td>\n</tr>\n<tr>\n<td>SQL parameter</td>\n<td>The input parameter format is <code>key1=value1;key2=value2...</code>.</td>\n</tr>\n<tr>\n<td>SQL statement</td>\n<td>SQL statement.</td>\n</tr>\n<tr>\n<td>UDF function</td>\n<td>For Hive DataSources, you can refer to UDF functions created in the resource center, but other DataSource do not support UDF functions.</td>\n</tr>\n<tr>\n<td>Custom parameters</td>\n<td>SQL task type, and stored procedure is a custom parameter order, to set customized parameter type and data type for the method is the same as the stored procedure task type. The difference is that the custom parameter of the SQL task type replaces the <code>${variable}</code> in the SQL statement.</td>\n</tr>\n<tr>\n<td>Pre-SQL</td>\n<td>Pre-SQL executes before the SQL statement.</td>\n</tr>\n<tr>\n<td>Post-SQL</td>\n<td>Post-SQL executes after the SQL statement.</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"task_example\">Task Example</h2>\n<h3 id=\"hive_table_create_example\">Hive Table Create Example</h3>\n<h4 id=\"create_a_temporary_table_in_hive_and_write_data\">Create a Temporary Table in Hive and Write Data</h4>\n<p>This example creates a temporary table <code>tmp_hello_world</code> in Hive and writes a row of data. Before creating a temporary table, we need to ensure that the table does not exist. So we use custom parameters to obtain the time of the day as the suffix of the table name every time we run, this task can run every different day. The format of the created table name is: <code>tmp_hello_world_{yyyyMMdd}</code>.\n<strong>Note</strong>ï¼šthe hive datasource in the SQL task based on JDBC to execute SQLs, SQL statement does not support multi-statements, please avoid using ';' at the end of the statement. To process multi-statements please use <a href=\"/en-us/docs/3.1.0/guide/task/hive-cli\">Hive-Cli</a> task.</p>\n<p><img src=\"/img/tasks/demo/hive-sql.png\" alt=\"hive-sql\"></p>\n<h4 id=\"after_running_the_task_successfully,_query_the_results_in_hive\">After Running the Task Successfully, Query the Results in Hive</h4>\n<p>Log in to the bigdata cluster and use 'hive' command or 'beeline' or 'JDBC' and other methods to connect to the 'Apache Hive' for the query. The query SQL is <code>select * from tmp_hello_world_{yyyyMMdd}</code>, please replace <code>{yyyyMMdd}</code> with the date of the running day. The following shows the query screenshot:</p>\n<p><img src=\"/img/tasks/demo/hive-result.png\" alt=\"hive-sql\"></p>\n<h3 id=\"use_pre-sql_and_post-sql_example\">Use Pre-SQL and Post-SQL Example</h3>\n<p>Table created in the Pre-SQL, after use in the SQL statement, cleaned in the Post-SQL</p>\n<p><img src=\"/img/tasks/demo/pre_post_sql.png\" alt=\"pre_post_sql\"></p>\n<h2 id=\"note\">Note</h2>\n<p>Pay attention to the selection of SQL type. If it is an insert operation, need to change to &quot;Non-Query&quot; type.</p>\n<p>To compatible with long session,UDF function are created by the syntax(CREATE OR REPLACE)</p>\n",
  "location": [
    "Introduction to Functions",
    "Task",
    "SQL"
  ],
  "time": "2022-9-30",
  "structure": [
    {
      "title": "Overview",
      "children": [
        {
          "title": "Hive Table Create Example",
          "children": [
            {
              "title": "Create a Temporary Table in Hive and Write Data",
              "children": [],
              "anchor": "create_a_temporary_table_in_hive_and_write_data"
            },
            {
              "title": "After Running the Task Successfully, Query the Results in Hive",
              "children": [],
              "anchor": "after_running_the_task_successfully,_query_the_results_in_hive"
            }
          ],
          "anchor": "hive_table_create_example"
        },
        {
          "title": "Use Pre-SQL and Post-SQL Example",
          "children": [
            {
              "title": "Create a Temporary Table in Hive and Write Data",
              "children": [],
              "anchor": "create_a_temporary_table_in_hive_and_write_data"
            },
            {
              "title": "After Running the Task Successfully, Query the Results in Hive",
              "children": [],
              "anchor": "after_running_the_task_successfully,_query_the_results_in_hive"
            }
          ],
          "anchor": "use_pre-sql_and_post-sql_example"
        }
      ],
      "anchor": "overview"
    },
    {
      "title": "Create DataSource",
      "children": [
        {
          "title": "Hive Table Create Example",
          "children": [
            {
              "title": "Create a Temporary Table in Hive and Write Data",
              "children": [],
              "anchor": "create_a_temporary_table_in_hive_and_write_data"
            },
            {
              "title": "After Running the Task Successfully, Query the Results in Hive",
              "children": [],
              "anchor": "after_running_the_task_successfully,_query_the_results_in_hive"
            }
          ],
          "anchor": "hive_table_create_example"
        },
        {
          "title": "Use Pre-SQL and Post-SQL Example",
          "children": [
            {
              "title": "Create a Temporary Table in Hive and Write Data",
              "children": [],
              "anchor": "create_a_temporary_table_in_hive_and_write_data"
            },
            {
              "title": "After Running the Task Successfully, Query the Results in Hive",
              "children": [],
              "anchor": "after_running_the_task_successfully,_query_the_results_in_hive"
            }
          ],
          "anchor": "use_pre-sql_and_post-sql_example"
        }
      ],
      "anchor": "create_datasource"
    },
    {
      "title": "Create Task",
      "children": [
        {
          "title": "Hive Table Create Example",
          "children": [
            {
              "title": "Create a Temporary Table in Hive and Write Data",
              "children": [],
              "anchor": "create_a_temporary_table_in_hive_and_write_data"
            },
            {
              "title": "After Running the Task Successfully, Query the Results in Hive",
              "children": [],
              "anchor": "after_running_the_task_successfully,_query_the_results_in_hive"
            }
          ],
          "anchor": "hive_table_create_example"
        },
        {
          "title": "Use Pre-SQL and Post-SQL Example",
          "children": [
            {
              "title": "Create a Temporary Table in Hive and Write Data",
              "children": [],
              "anchor": "create_a_temporary_table_in_hive_and_write_data"
            },
            {
              "title": "After Running the Task Successfully, Query the Results in Hive",
              "children": [],
              "anchor": "after_running_the_task_successfully,_query_the_results_in_hive"
            }
          ],
          "anchor": "use_pre-sql_and_post-sql_example"
        }
      ],
      "anchor": "create_task"
    },
    {
      "title": "Task Parameter",
      "children": [
        {
          "title": "Hive Table Create Example",
          "children": [
            {
              "title": "Create a Temporary Table in Hive and Write Data",
              "children": [],
              "anchor": "create_a_temporary_table_in_hive_and_write_data"
            },
            {
              "title": "After Running the Task Successfully, Query the Results in Hive",
              "children": [],
              "anchor": "after_running_the_task_successfully,_query_the_results_in_hive"
            }
          ],
          "anchor": "hive_table_create_example"
        },
        {
          "title": "Use Pre-SQL and Post-SQL Example",
          "children": [
            {
              "title": "Create a Temporary Table in Hive and Write Data",
              "children": [],
              "anchor": "create_a_temporary_table_in_hive_and_write_data"
            },
            {
              "title": "After Running the Task Successfully, Query the Results in Hive",
              "children": [],
              "anchor": "after_running_the_task_successfully,_query_the_results_in_hive"
            }
          ],
          "anchor": "use_pre-sql_and_post-sql_example"
        }
      ],
      "anchor": "task_parameter"
    },
    {
      "title": "Task Example",
      "children": [
        {
          "title": "Hive Table Create Example",
          "children": [
            {
              "title": "Create a Temporary Table in Hive and Write Data",
              "children": [],
              "anchor": "create_a_temporary_table_in_hive_and_write_data"
            },
            {
              "title": "After Running the Task Successfully, Query the Results in Hive",
              "children": [],
              "anchor": "after_running_the_task_successfully,_query_the_results_in_hive"
            }
          ],
          "anchor": "hive_table_create_example"
        },
        {
          "title": "Use Pre-SQL and Post-SQL Example",
          "children": [
            {
              "title": "Create a Temporary Table in Hive and Write Data",
              "children": [],
              "anchor": "create_a_temporary_table_in_hive_and_write_data"
            },
            {
              "title": "After Running the Task Successfully, Query the Results in Hive",
              "children": [],
              "anchor": "after_running_the_task_successfully,_query_the_results_in_hive"
            }
          ],
          "anchor": "use_pre-sql_and_post-sql_example"
        }
      ],
      "anchor": "task_example"
    },
    {
      "title": "Note",
      "children": [
        {
          "title": "Hive Table Create Example",
          "children": [
            {
              "title": "Create a Temporary Table in Hive and Write Data",
              "children": [],
              "anchor": "create_a_temporary_table_in_hive_and_write_data"
            },
            {
              "title": "After Running the Task Successfully, Query the Results in Hive",
              "children": [],
              "anchor": "after_running_the_task_successfully,_query_the_results_in_hive"
            }
          ],
          "anchor": "hive_table_create_example"
        },
        {
          "title": "Use Pre-SQL and Post-SQL Example",
          "children": [
            {
              "title": "Create a Temporary Table in Hive and Write Data",
              "children": [],
              "anchor": "create_a_temporary_table_in_hive_and_write_data"
            },
            {
              "title": "After Running the Task Successfully, Query the Results in Hive",
              "children": [],
              "anchor": "after_running_the_task_successfully,_query_the_results_in_hive"
            }
          ],
          "anchor": "use_pre-sql_and_post-sql_example"
        }
      ],
      "anchor": "note"
    }
  ],
  "title": "SQL",
  "link": "/guide/task/sql"
}