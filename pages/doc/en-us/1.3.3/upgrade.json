{
  "__html": "<h1 id=\"dolphinscheduler_upgrade_documentation\">DolphinScheduler upgrade documentation</h1>\n<h2 id=\"1._back_up_previous_version's_files_and_database.\">1. Back up previous version's files and database.</h2>\n<h2 id=\"2._stop_all_services_of_dolphinscheduler.\">2. Stop all services of DolphinScheduler.</h2>\n<p><code>sh ./script/stop-all.sh</code></p>\n<h2 id=\"3._download_the_new_version's_installation_package.\">3. Download the new version's installation package.</h2>\n<ul>\n<li><a href=\"/en-us/download/download.html\">download</a> the latest version of the installation packages.</li>\n<li>The following upgrade operations need to be performed in the new version's directory.</li>\n</ul>\n<h2 id=\"4._database_upgrade\">4. Database upgrade</h2>\n<ul>\n<li>\n<p>Modify the following properties in conf/datasource.properties.</p>\n</li>\n<li>\n<p>If you use MySQL as database to run DolphinScheduler, please comment out PostgreSQL releated configurations, and add mysql connector jar into lib dir, here we download mysql-connector-java-5.1.47.jar, and then correctly config database connect infoformation. You can download mysql connector jar <a href=\"https://downloads.MySQL.com/archives/c-j/\">here</a>. Alternatively if you use Postgres as database, you just need to comment out Mysql related configurations, and correctly config database connect information.</p>\n<pre><code class=\"language-properties\"><span class=\"hljs-comment\">  # postgre</span>\n<span class=\"hljs-comment\">  #spring.datasource.driver-class-name=org.postgresql.Driver</span>\n<span class=\"hljs-comment\">  #spring.datasource.url=jdbc:postgresql://localhost:5432/dolphinscheduler</span>\n<span class=\"hljs-comment\">  # mysql</span>\n  <span class=\"hljs-attr\">spring.datasource.driver-class-name</span>=<span class=\"hljs-string\">com.mysql.jdbc.Driver</span>\n  <span class=\"hljs-attr\">spring.datasource.url</span>=<span class=\"hljs-string\">jdbc:mysql://xxx:3306/dolphinscheduler?useUnicode=true&amp;characterEncoding=UTF-8&amp;allowMultiQueries=true</span>\n  <span class=\"hljs-attr\">spring.datasource.username</span>=<span class=\"hljs-string\">xxx</span>\n  <span class=\"hljs-attr\">spring.datasource.password</span>=<span class=\"hljs-string\">xxx</span>\n</code></pre>\n</li>\n<li>\n<p>Execute database upgrade script</p>\n<p><code>sh ./script/upgrade-dolphinscheduler.sh</code></p>\n</li>\n</ul>\n<h2 id=\"5._backend_service_upgrade.\">5. Backend service upgrade.</h2>\n<h3 id=\"5.1_modify_the_content_in_<code>conf/config/install_config.conf</code>_file.\">5.1 Modify the content in <code>conf/config/install_config.conf</code> file.</h3>\n<ul>\n<li>Standalone Deployment please refer the [6, Modify running arguments] in <a href=\"./standalone-deployment.md\">Standalone-Deployment</a>.</li>\n<li>Cluster Deployment please refer the [6, Modify running arguments] in <a href=\"./cluster-deployment.md\">Cluster-Deployment</a>.</li>\n</ul>\n<h4 id=\"masters_need_attentions\">Masters need attentions</h4>\n<p>Create worker group in 1.3.1 version has different design:</p>\n<ul>\n<li>Brfore version 1.3.1 worker group can be created through UI interface.</li>\n<li>Since version 1.3.1 worker group can be created by modify the worker configuration.</li>\n</ul>\n<h4 id=\"when_upgrade_from_version_before_1.3.1_to_1.3.2,_below_operations_are_what_we_need_to_do_to_keep_worker_group_config_consist_with_previous.\">When upgrade from version before 1.3.1 to 1.3.2, below operations are what we need to do to keep worker group config consist with previous.</h4>\n<p>1, Go to the backup database, search records in t_ds_worker_group table, mainly focus id, name and ip these three columns.</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">id</th>\n<th style=\"text-align:center\">name</th>\n<th style=\"text-align:right\">ip_list</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">1</td>\n<td style=\"text-align:center\">service1</td>\n<td style=\"text-align:right\">192.168.xx.10</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">2</td>\n<td style=\"text-align:center\">service2</td>\n<td style=\"text-align:right\">192.168.xx.11,192.168.xx.12</td>\n</tr>\n</tbody>\n</table>\n<p>2„ÄÅModify the workers config item in conf/config/install_config.conf file.</p>\n<p>Imaging bellow are the machine worker service to be deployed:</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">hostname</th>\n<th style=\"text-align:center\">ip</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">ds1</td>\n<td style=\"text-align:center\">192.168.xx.10</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ds2</td>\n<td style=\"text-align:center\">192.168.xx.11</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ds3</td>\n<td style=\"text-align:center\">192.168.xx.12</td>\n</tr>\n</tbody>\n</table>\n<p>To keep worker group config consistent with previous version, we need to modify workers config item as below:</p>\n<pre><code class=\"language-shell\"><span class=\"hljs-meta prompt_\">#</span><span class=\"language-bash\">worker service is deployed on <span class=\"hljs-built_in\">which</span> machine, and also specify <span class=\"hljs-built_in\">which</span> worker group this worker belong to.</span> \nworkers=&quot;ds1:service1,ds2:service2,ds3:service2&quot;\n</code></pre>\n<h4 id=\"the_worker_group_has_been_enhanced_in_version_1.3.2.\">The worker group has been enhanced in version 1.3.2.</h4>\n<p>Worker in 1.3.1 can't belong to more than one worker group, in 1.3.2 it's supported. So in 1.3.1 it's not supported when workers=&quot;ds1:service1,ds1:service2&quot;, and in 1.3.2 it's supported.</p>\n<h3 id=\"5.2_execute_deploy_script.\">5.2 Execute deploy script.</h3>\n<pre><code class=\"language-shell\">`sh install.sh`\n</code></pre>\n",
  "location": [
    "Upgrade",
    "Upgrade"
  ],
  "time": "2020-11-9",
  "structure": [
    {
      "title": "1. Back up previous version's files and database.",
      "children": [
        {
          "title": "5.1 Modify the content in conf/config/install_config.conf file.",
          "children": [
            {
              "title": "Masters need attentions",
              "children": [],
              "anchor": "masters_need_attentions"
            },
            {
              "title": "When upgrade from version before 1.3.1 to 1.3.2, below operations are what we need to do to keep worker group config consist with previous.",
              "children": [],
              "anchor": "when_upgrade_from_version_before_1.3.1_to_1.3.2,_below_operations_are_what_we_need_to_do_to_keep_worker_group_config_consist_with_previous."
            },
            {
              "title": "The worker group has been enhanced in version 1.3.2.",
              "children": [],
              "anchor": "the_worker_group_has_been_enhanced_in_version_1.3.2."
            }
          ],
          "anchor": "5.1_modify_the_content_in_conf/config/install_config.conf_file."
        },
        {
          "title": "5.2 Execute deploy script.",
          "children": [
            {
              "title": "Masters need attentions",
              "children": [],
              "anchor": "masters_need_attentions"
            },
            {
              "title": "When upgrade from version before 1.3.1 to 1.3.2, below operations are what we need to do to keep worker group config consist with previous.",
              "children": [],
              "anchor": "when_upgrade_from_version_before_1.3.1_to_1.3.2,_below_operations_are_what_we_need_to_do_to_keep_worker_group_config_consist_with_previous."
            },
            {
              "title": "The worker group has been enhanced in version 1.3.2.",
              "children": [],
              "anchor": "the_worker_group_has_been_enhanced_in_version_1.3.2."
            }
          ],
          "anchor": "5.2_execute_deploy_script."
        }
      ],
      "anchor": "1._back_up_previous_version's_files_and_database."
    },
    {
      "title": "2. Stop all services of DolphinScheduler.",
      "children": [
        {
          "title": "5.1 Modify the content in conf/config/install_config.conf file.",
          "children": [
            {
              "title": "Masters need attentions",
              "children": [],
              "anchor": "masters_need_attentions"
            },
            {
              "title": "When upgrade from version before 1.3.1 to 1.3.2, below operations are what we need to do to keep worker group config consist with previous.",
              "children": [],
              "anchor": "when_upgrade_from_version_before_1.3.1_to_1.3.2,_below_operations_are_what_we_need_to_do_to_keep_worker_group_config_consist_with_previous."
            },
            {
              "title": "The worker group has been enhanced in version 1.3.2.",
              "children": [],
              "anchor": "the_worker_group_has_been_enhanced_in_version_1.3.2."
            }
          ],
          "anchor": "5.1_modify_the_content_in_conf/config/install_config.conf_file."
        },
        {
          "title": "5.2 Execute deploy script.",
          "children": [
            {
              "title": "Masters need attentions",
              "children": [],
              "anchor": "masters_need_attentions"
            },
            {
              "title": "When upgrade from version before 1.3.1 to 1.3.2, below operations are what we need to do to keep worker group config consist with previous.",
              "children": [],
              "anchor": "when_upgrade_from_version_before_1.3.1_to_1.3.2,_below_operations_are_what_we_need_to_do_to_keep_worker_group_config_consist_with_previous."
            },
            {
              "title": "The worker group has been enhanced in version 1.3.2.",
              "children": [],
              "anchor": "the_worker_group_has_been_enhanced_in_version_1.3.2."
            }
          ],
          "anchor": "5.2_execute_deploy_script."
        }
      ],
      "anchor": "2._stop_all_services_of_dolphinscheduler."
    },
    {
      "title": "3. Download the new version's installation package.",
      "children": [
        {
          "title": "5.1 Modify the content in conf/config/install_config.conf file.",
          "children": [
            {
              "title": "Masters need attentions",
              "children": [],
              "anchor": "masters_need_attentions"
            },
            {
              "title": "When upgrade from version before 1.3.1 to 1.3.2, below operations are what we need to do to keep worker group config consist with previous.",
              "children": [],
              "anchor": "when_upgrade_from_version_before_1.3.1_to_1.3.2,_below_operations_are_what_we_need_to_do_to_keep_worker_group_config_consist_with_previous."
            },
            {
              "title": "The worker group has been enhanced in version 1.3.2.",
              "children": [],
              "anchor": "the_worker_group_has_been_enhanced_in_version_1.3.2."
            }
          ],
          "anchor": "5.1_modify_the_content_in_conf/config/install_config.conf_file."
        },
        {
          "title": "5.2 Execute deploy script.",
          "children": [
            {
              "title": "Masters need attentions",
              "children": [],
              "anchor": "masters_need_attentions"
            },
            {
              "title": "When upgrade from version before 1.3.1 to 1.3.2, below operations are what we need to do to keep worker group config consist with previous.",
              "children": [],
              "anchor": "when_upgrade_from_version_before_1.3.1_to_1.3.2,_below_operations_are_what_we_need_to_do_to_keep_worker_group_config_consist_with_previous."
            },
            {
              "title": "The worker group has been enhanced in version 1.3.2.",
              "children": [],
              "anchor": "the_worker_group_has_been_enhanced_in_version_1.3.2."
            }
          ],
          "anchor": "5.2_execute_deploy_script."
        }
      ],
      "anchor": "3._download_the_new_version's_installation_package."
    },
    {
      "title": "4. Database upgrade",
      "children": [
        {
          "title": "5.1 Modify the content in conf/config/install_config.conf file.",
          "children": [
            {
              "title": "Masters need attentions",
              "children": [],
              "anchor": "masters_need_attentions"
            },
            {
              "title": "When upgrade from version before 1.3.1 to 1.3.2, below operations are what we need to do to keep worker group config consist with previous.",
              "children": [],
              "anchor": "when_upgrade_from_version_before_1.3.1_to_1.3.2,_below_operations_are_what_we_need_to_do_to_keep_worker_group_config_consist_with_previous."
            },
            {
              "title": "The worker group has been enhanced in version 1.3.2.",
              "children": [],
              "anchor": "the_worker_group_has_been_enhanced_in_version_1.3.2."
            }
          ],
          "anchor": "5.1_modify_the_content_in_conf/config/install_config.conf_file."
        },
        {
          "title": "5.2 Execute deploy script.",
          "children": [
            {
              "title": "Masters need attentions",
              "children": [],
              "anchor": "masters_need_attentions"
            },
            {
              "title": "When upgrade from version before 1.3.1 to 1.3.2, below operations are what we need to do to keep worker group config consist with previous.",
              "children": [],
              "anchor": "when_upgrade_from_version_before_1.3.1_to_1.3.2,_below_operations_are_what_we_need_to_do_to_keep_worker_group_config_consist_with_previous."
            },
            {
              "title": "The worker group has been enhanced in version 1.3.2.",
              "children": [],
              "anchor": "the_worker_group_has_been_enhanced_in_version_1.3.2."
            }
          ],
          "anchor": "5.2_execute_deploy_script."
        }
      ],
      "anchor": "4._database_upgrade"
    },
    {
      "title": "5. Backend service upgrade.",
      "children": [
        {
          "title": "5.1 Modify the content in conf/config/install_config.conf file.",
          "children": [
            {
              "title": "Masters need attentions",
              "children": [],
              "anchor": "masters_need_attentions"
            },
            {
              "title": "When upgrade from version before 1.3.1 to 1.3.2, below operations are what we need to do to keep worker group config consist with previous.",
              "children": [],
              "anchor": "when_upgrade_from_version_before_1.3.1_to_1.3.2,_below_operations_are_what_we_need_to_do_to_keep_worker_group_config_consist_with_previous."
            },
            {
              "title": "The worker group has been enhanced in version 1.3.2.",
              "children": [],
              "anchor": "the_worker_group_has_been_enhanced_in_version_1.3.2."
            }
          ],
          "anchor": "5.1_modify_the_content_in_conf/config/install_config.conf_file."
        },
        {
          "title": "5.2 Execute deploy script.",
          "children": [
            {
              "title": "Masters need attentions",
              "children": [],
              "anchor": "masters_need_attentions"
            },
            {
              "title": "When upgrade from version before 1.3.1 to 1.3.2, below operations are what we need to do to keep worker group config consist with previous.",
              "children": [],
              "anchor": "when_upgrade_from_version_before_1.3.1_to_1.3.2,_below_operations_are_what_we_need_to_do_to_keep_worker_group_config_consist_with_previous."
            },
            {
              "title": "The worker group has been enhanced in version 1.3.2.",
              "children": [],
              "anchor": "the_worker_group_has_been_enhanced_in_version_1.3.2."
            }
          ],
          "anchor": "5.2_execute_deploy_script."
        }
      ],
      "anchor": "5._backend_service_upgrade."
    }
  ],
  "title": "DolphinScheduler upgrade documentation",
  "link": "/upgrade"
}