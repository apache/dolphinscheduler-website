{
  "__html": "<h1 id=\"load-balancing\">Load Balancing</h1>\n<p>Load balancing distributes server pressure reasonably through routing algorithms (typically in cluster environments) to optimize server performance to the maximum extent.</p>\n<h2 id=\"dolphinscheduler-worker-load-balancing-algorithms\">DolphinScheduler-Worker Load Balancing Algorithms</h2>\n<p>DolphinScheduler-Master provides four load balancing algorithms for distributing tasks to workers:</p>\n<ul>\n<li><strong>Random</strong> (RANDOM)</li>\n<li><strong>Round Robin</strong> (ROUND_ROBIN)</li>\n<li><strong>Smooth Round Robin</strong> (FIXED_WEIGHTED_ROUND_ROBIN)</li>\n<li><strong>Dynamic Smooth Round Robin</strong> (DYNAMIC_WEIGHTED_ROUND_ROBIN) - Default algorithm</li>\n</ul>\n<h2 id=\"load-balancing-configuration\">Load Balancing Configuration</h2>\n<p>Configure the load balancing algorithm in the configuration file:</p>\n<p>Location: <code>master-server/conf/application.yaml</code></p>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">worker-load-balancer-configuration-properties:</span>\n  <span class=\"hljs-comment\"># types: RANDOM, ROUND_ROBIN, FIXED_WEIGHTED_ROUND_ROBIN, DYNAMIC_WEIGHTED_ROUND_ROBIN</span>\n  <span class=\"hljs-attr\">type:</span> <span class=\"hljs-string\">DYNAMIC_WEIGHTED_ROUND_ROBIN</span>\n</code></pre>\n<h2 id=\"worker-weight-configuration\">Worker Weight Configuration</h2>\n<h3 id=\"smooth-round-robin-configuration-(fixed_weighted_round_robin)\">Smooth Round Robin Configuration (FIXED_WEIGHTED_ROUND_ROBIN)</h3>\n<p>For the <code>FIXED_WEIGHTED_ROUND_ROBIN</code> algorithm, you can modify the fixed weight in each worker's configuration file:</p>\n<p>Location: <code>worker-server/conf/application.yaml</code></p>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">worker:</span>\n  <span class=\"hljs-attr\">host-weight:</span> <span class=\"hljs-number\">100</span> <span class=\"hljs-comment\">#default value is 100</span>\n</code></pre>\n<h3 id=\"dynamic-smooth-round-robin-configuration-(dynamic_weighted_round_robin)\">Dynamic Smooth Round Robin Configuration (DYNAMIC_WEIGHTED_ROUND_ROBIN)</h3>\n<p>When using the <code>DYNAMIC_WEIGHTED_ROUND_ROBIN</code> algorithm, you can configure the weights for various metrics:</p>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">master:</span>\n  <span class=\"hljs-attr\">worker-load-balancer-configuration-properties:</span>\n    <span class=\"hljs-attr\">type:</span> <span class=\"hljs-string\">DYNAMIC_WEIGHTED_ROUND_ROBIN</span>\n    <span class=\"hljs-comment\"># Dynamic weight configuration, only used for DYNAMIC_WEIGHTED_ROUND_ROBIN algorithm</span>\n    <span class=\"hljs-comment\"># The sum of memory-usage, cpu-usage, task-thread-pool-usage weights must be 100</span>\n    <span class=\"hljs-attr\">dynamic-weight-config-properties:</span>\n      <span class=\"hljs-attr\">memory-usage-weight:</span> <span class=\"hljs-number\">30</span>    <span class=\"hljs-comment\"># Memory usage weight</span>\n      <span class=\"hljs-attr\">cpu-usage-weight:</span> <span class=\"hljs-number\">30</span>       <span class=\"hljs-comment\"># CPU usage weight  </span>\n      <span class=\"hljs-attr\">task-thread-pool-usage-weight:</span> <span class=\"hljs-number\">40</span>  <span class=\"hljs-comment\"># Task thread pool usage weight</span>\n</code></pre>\n<h2 id=\"load-balancing-algorithm-details\">Load Balancing Algorithm Details</h2>\n<h3 id=\"random-(random)\">Random (RANDOM)</h3>\n<p>Randomly selects one available worker node to execute tasks.</p>\n<h3 id=\"round-robin-(round_robin)\">Round Robin (ROUND_ROBIN)</h3>\n<p>Selects worker nodes in a fixed order to ensure each worker receives tasks evenly.</p>\n<h3 id=\"smooth-round-robin-(fixed_weighted_round_robin)\">Smooth Round Robin (FIXED_WEIGHTED_ROUND_ROBIN)</h3>\n<p>Each worker has two weights: weight (remains constant after warm-up) and current_weight (dynamically changes). During each routing, all workers are traversed, and their current_weight is increased by their weight. The total weight of all workers is accumulated as total_weight. The worker with the highest current_weight is selected to execute the task, and then that worker's current_weight is decreased by total_weight.</p>\n<ul>\n<li>Example: For instance, with 3 workers (A, B, C) having weights of 1, 2, and 3 respectively</li>\n<li>Worker selection order will be: C B C A B C C B C A B C C B C A B C C B C A B C C B C A B C ... (In this 30-round scheduling example, the number of tasks allocated to each worker is: C:15, B:10, A:5, exactly matching the weight ratio)</li>\n</ul>\n<h3 id=\"dynamic-smooth-round-robin-(dynamic_weighted_round_robin)---default-algorithm\">Dynamic Smooth Round Robin (DYNAMIC_WEIGHTED_ROUND_ROBIN) - Default Algorithm</h3>\n<p>This algorithm reports its own load information to the registry at regular intervals. We primarily evaluate based on CPU usage, memory usage, and worker thread pool usage, with specific weight configurations as follows:</p>\n<ul>\n<li><strong>Memory Usage</strong> (Default weight: 30%)</li>\n<li><strong>CPU Usage</strong> (Default weight: 30%)</li>\n<li><strong>Task Thread Pool Usage</strong> (Default weight: 40%)</li>\n</ul>\n<p><strong>Weight Calculation Principle:</strong>\nThe dynamic weight of each worker is calculated using the following formula:</p>\n<pre><code>Weight = 100 - (CPU Weight × CPU Usage + Memory Weight × Memory Usage + Thread Pool Weight × Thread Pool Usage) ÷ 3\n</code></pre>\n<p>Therefore, when a worker's load is lower, its weight will be higher, and the system will prioritize selecting worker nodes with lower loads to execute tasks.</p>\n<p>In the final worker node selection process, the workflow is consistent with smooth round robin, with the only difference being that in this algorithm, worker weights change dynamically.\nThrough this dynamic smooth round robin algorithm, DolphinScheduler can intelligently distribute tasks to workers with the lowest loads, achieving true dynamic load balancing.</p>\n",
  "location": [
    "Architecture Guide",
    "Load Balance"
  ],
  "structure": [
    {
      "title": "DolphinScheduler-Worker Load Balancing Algorithms",
      "children": [
        {
          "title": "Smooth Round Robin Configuration (FIXED_WEIGHTED_ROUND_ROBIN)",
          "children": [],
          "anchor": "smooth-round-robin-configuration-(fixed_weighted_round_robin)"
        },
        {
          "title": "Dynamic Smooth Round Robin Configuration (DYNAMIC_WEIGHTED_ROUND_ROBIN)",
          "children": [],
          "anchor": "dynamic-smooth-round-robin-configuration-(dynamic_weighted_round_robin)"
        },
        {
          "title": "Random (RANDOM)",
          "children": [],
          "anchor": "random-(random)"
        },
        {
          "title": "Round Robin (ROUND_ROBIN)",
          "children": [],
          "anchor": "round-robin-(round_robin)"
        },
        {
          "title": "Smooth Round Robin (FIXED_WEIGHTED_ROUND_ROBIN)",
          "children": [],
          "anchor": "smooth-round-robin-(fixed_weighted_round_robin)"
        },
        {
          "title": "Dynamic Smooth Round Robin (DYNAMIC_WEIGHTED_ROUND_ROBIN) - Default Algorithm",
          "children": [],
          "anchor": "dynamic-smooth-round-robin-(dynamic_weighted_round_robin)---default-algorithm"
        }
      ],
      "anchor": "dolphinscheduler-worker-load-balancing-algorithms"
    },
    {
      "title": "Load Balancing Configuration",
      "children": [
        {
          "title": "Smooth Round Robin Configuration (FIXED_WEIGHTED_ROUND_ROBIN)",
          "children": [],
          "anchor": "smooth-round-robin-configuration-(fixed_weighted_round_robin)"
        },
        {
          "title": "Dynamic Smooth Round Robin Configuration (DYNAMIC_WEIGHTED_ROUND_ROBIN)",
          "children": [],
          "anchor": "dynamic-smooth-round-robin-configuration-(dynamic_weighted_round_robin)"
        },
        {
          "title": "Random (RANDOM)",
          "children": [],
          "anchor": "random-(random)"
        },
        {
          "title": "Round Robin (ROUND_ROBIN)",
          "children": [],
          "anchor": "round-robin-(round_robin)"
        },
        {
          "title": "Smooth Round Robin (FIXED_WEIGHTED_ROUND_ROBIN)",
          "children": [],
          "anchor": "smooth-round-robin-(fixed_weighted_round_robin)"
        },
        {
          "title": "Dynamic Smooth Round Robin (DYNAMIC_WEIGHTED_ROUND_ROBIN) - Default Algorithm",
          "children": [],
          "anchor": "dynamic-smooth-round-robin-(dynamic_weighted_round_robin)---default-algorithm"
        }
      ],
      "anchor": "load-balancing-configuration"
    },
    {
      "title": "Worker Weight Configuration",
      "children": [
        {
          "title": "Smooth Round Robin Configuration (FIXED_WEIGHTED_ROUND_ROBIN)",
          "children": [],
          "anchor": "smooth-round-robin-configuration-(fixed_weighted_round_robin)"
        },
        {
          "title": "Dynamic Smooth Round Robin Configuration (DYNAMIC_WEIGHTED_ROUND_ROBIN)",
          "children": [],
          "anchor": "dynamic-smooth-round-robin-configuration-(dynamic_weighted_round_robin)"
        },
        {
          "title": "Random (RANDOM)",
          "children": [],
          "anchor": "random-(random)"
        },
        {
          "title": "Round Robin (ROUND_ROBIN)",
          "children": [],
          "anchor": "round-robin-(round_robin)"
        },
        {
          "title": "Smooth Round Robin (FIXED_WEIGHTED_ROUND_ROBIN)",
          "children": [],
          "anchor": "smooth-round-robin-(fixed_weighted_round_robin)"
        },
        {
          "title": "Dynamic Smooth Round Robin (DYNAMIC_WEIGHTED_ROUND_ROBIN) - Default Algorithm",
          "children": [],
          "anchor": "dynamic-smooth-round-robin-(dynamic_weighted_round_robin)---default-algorithm"
        }
      ],
      "anchor": "worker-weight-configuration"
    },
    {
      "title": "Load Balancing Algorithm Details",
      "children": [
        {
          "title": "Smooth Round Robin Configuration (FIXED_WEIGHTED_ROUND_ROBIN)",
          "children": [],
          "anchor": "smooth-round-robin-configuration-(fixed_weighted_round_robin)"
        },
        {
          "title": "Dynamic Smooth Round Robin Configuration (DYNAMIC_WEIGHTED_ROUND_ROBIN)",
          "children": [],
          "anchor": "dynamic-smooth-round-robin-configuration-(dynamic_weighted_round_robin)"
        },
        {
          "title": "Random (RANDOM)",
          "children": [],
          "anchor": "random-(random)"
        },
        {
          "title": "Round Robin (ROUND_ROBIN)",
          "children": [],
          "anchor": "round-robin-(round_robin)"
        },
        {
          "title": "Smooth Round Robin (FIXED_WEIGHTED_ROUND_ROBIN)",
          "children": [],
          "anchor": "smooth-round-robin-(fixed_weighted_round_robin)"
        },
        {
          "title": "Dynamic Smooth Round Robin (DYNAMIC_WEIGHTED_ROUND_ROBIN) - Default Algorithm",
          "children": [],
          "anchor": "dynamic-smooth-round-robin-(dynamic_weighted_round_robin)---default-algorithm"
        }
      ],
      "anchor": "load-balancing-algorithm-details"
    }
  ],
  "title": "Load Balancing",
  "link": "/architecture/load-balance"
}