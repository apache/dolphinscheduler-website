<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="faq" />
	<meta name="description" content="faq" />
	<!-- 网页标签标题 -->
	<title>faq</title>
	<link rel="shortcut icon" href="/img/docsite.ico"/>
	<link rel="stylesheet" href="/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot=""><header class="header-container header-container-normal"><div class="header-body"><a href="/zh-cn/index.html"><img class="logo" src="/img/hlogo_colorful.svg"/></a><div class="search search-normal"><span class="icon-search"></span></div><span class="language-switch language-switch-normal">En</span><div class="header-menu"><img class="header-menu-toggle" src="/img/system/menu_gray.png"/><div><ul class="ant-menu blackClass ant-menu-light ant-menu-root ant-menu-horizontal" role="menu"><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/zh-cn/index.html" target="_self">首页</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-submenu ant-menu-submenu-horizontal" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span class="submenu-title-wrapper">文档</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/zh-cn/docs/release/download.html" target="_self">下载</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="http://106.75.43.194:8888" target="_blank">线上demo</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/zh-cn/blog/index.html" target="_self">博客</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/zh-cn/docs/development/subscribe.html" target="_self">开发者</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/zh-cn/community/index.html" target="_self">社区</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul></div></div></div></header><div class="bar"><div class="bar-body"><img src="/img/system/docs.png" class="front-img"/><span>文档</span><img src="/img/system/docs.png" class="back-img"/></div></div><section class="content-section"><div class="sidemenu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span>部署文档</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/1.2.1/user_doc/hardware-environment.html" target="_self">软硬件环境建议配置</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/1.2.1/user_doc/standalone-deployment.html" target="_self">单机部署(Standalone)</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/1.2.1/user_doc/cluster-deployment.html" target="_self">集群部署(Cluster)</a></li></ul></li><li class="menu-item menu-item-level-1"><span>用户手册</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/1.2.1/user_doc/quick-start.html" target="_self">快速上手</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/1.2.1/user_doc/system-manual.html" target="_self">用户手册</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/1.2.1/user_doc/metadata-1.2.html" target="_self">元数据文档</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/1.2.1/user_doc/deployparam.html" target="_self">部署参数分析</a></li></ul></li><li class="menu-item menu-item-level-1"><span>API文档</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="http://106.75.43.194:8888/dolphinscheduler/doc.html?language=zh_CN&amp;lang=zh" target="_blank">API文档</a></li></ul></li><li class="menu-item menu-item-level-1"><span>版本升级</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/1.2.1/user_doc/upgrade.html" target="_self">升级</a></li></ul></li><li class="menu-item menu-item-level-1"><span>FAQ</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/release/faq.html" target="_self">FAQ</a></li></ul></li></ul></div><div class="doc-content markdown-body"><h2>Q：DolphinScheduler服务介绍及建议运行内存</h2>
<p>A： DolphinScheduler由5个服务组成，MasterServer、WorkerServer、ApiServer、AlertServer、LoggerServer和UI。</p>
<table>
<thead>
<tr>
<th>服务</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>MasterServer</td>
<td>主要负责 <strong>DAG</strong> 的切分和任务状态的监控</td>
</tr>
<tr>
<td>WorkerServer/LoggerServer</td>
<td>主要负责任务的提交、执行和任务状态的更新。LoggerServer用于Rest Api通过 <strong>RPC</strong> 查看日志</td>
</tr>
<tr>
<td>ApiServer</td>
<td>提供Rest Api服务，供UI进行调用</td>
</tr>
<tr>
<td>AlertServer</td>
<td>提供告警服务</td>
</tr>
<tr>
<td>UI</td>
<td>前端页面展示</td>
</tr>
</tbody>
</table>
<p>注意：<strong>由于服务比较多，建议单机部署最好是4核16G以上</strong></p>
<hr>
<h2>Q：系统支持哪些邮箱？</h2>
<p>A：支持绝大多数邮箱，qq、163、126、139、outlook、aliyun等皆支持。支持<strong>TLS和SSL</strong>协议，可以在alert.properties中选择性配置</p>
<hr>
<h2>Q：常用的系统变量时间参数有哪些，如何使用？</h2>
<p>A：请参考 使用手册</p>
<hr>
<h2>Q：pip install kazoo 这个安装报错。是必须安装的吗？</h2>
<p>A： 这个是python连接Zookeeper需要使用到的，必须要安装</p>
<hr>
<h2>Q: 怎么指定机器运行任务</h2>
<p>A：使用 <strong>管理员</strong> 创建Worker分组，在 <strong>流程定义启动</strong> 的时候可<strong>指定Worker分组</strong>或者在<strong>任务节点上指定Worker分组</strong>。如果不指定，则使用Default，<strong>Default默认是使用的集群里所有的Worker中随机选取一台来进行任务提交、执行</strong></p>
<hr>
<h2>Q：任务的优先级</h2>
<p>A：我们同时 <strong>支持流程和任务的优先级</strong>。优先级我们有 <strong>HIGHEST、HIGH、MEDIUM、LOW和LOWEST</strong> 五种级别。<strong>可以设置不同流程实例之间的优先级，也可以设置同一个流程实例中不同任务实例的优先级</strong>。详细内容请参考任务优先级设计 <a href="https://analysys.github.io/easyscheduler_docs_cn/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html#%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1">https://analysys.github.io/easyscheduler_docs_cn/系统架构设计.html#系统架构设计</a></p>
<hr>
<h2>Q：dolphinscheduler-grpc报错</h2>
<p>A：在根目录下执行：mvn -U clean package assembly:assembly -Dmaven.test.skip=true ， 然后刷新下整个项目</p>
<hr>
<h2>Q：DolphinScheduler支持windows上运行么</h2>
<p>A： 理论上只有<strong>Worker是需要在Linux上运行的</strong>，其它的服务都是可以在windows上正常运行的。但是还是建议最好能在linux上部署使用</p>
<hr>
<h2>Q：UI 在 linux 编译node-sass提示：Error：EACCESS:permission denied，mkdir xxxx</h2>
<p>A：单独安装 <strong>npm install node-sass --unsafe-perm</strong>，之后再 <strong>npm install</strong></p>
<hr>
<h2>Q：UI 不能正常登陆访问</h2>
<p>A： 1，如果是node启动的查看dolphinscheduler-ui下的.env API_BASE配置是否是Api Server服务地址</p>
<p>​       2，如果是nginx启动的并且是通过<strong><a href="http://install-dolphinscheduler-ui.sh">install-dolphinscheduler-ui.sh</a></strong>安装的，查看</p>
<p>​              <strong>/etc/nginx/conf.d/dolphinscheduler.conf</strong>中的proxy_pass配置是否是Api Server服务地址</p>
<p>​        3，如果以上配置都是正确的，那么请查看Api Server服务是否是正常的，</p>
<p>​			curl <a href="http://192.168.xx.xx:12345/dolphinscheduler/users/get-user-info">http://192.168.xx.xx:12345/dolphinscheduler/users/get-user-info</a> 查看Api Server日志，</p>
<p>​			如果提示cn.dolphinscheduler.api.interceptor.LoginHandlerInterceptor:[76] - session info is null，则证			明Api Server服务是正常的</p>
<p>​        4，如果以上都没有问题，需要查看一下<strong>application.properties</strong> 中的 <strong>server.context-path 和				    			  server.port 配置</strong>是否正确</p>
<hr>
<h2>Q： 流程定义手动启动或调度启动之后，没有流程实例生成</h2>
<p>A： 1，首先通过<strong>jps 查看MasterServer服务是否存在</strong>，或者从服务监控直接查看zk中是否存在master服务</p>
<p>​	   2，如果存在master服务，查看 <strong>命令状态统计</strong> 或者 <strong>t_ds_error_command</strong> 中是否增加的新记录，如果增加了，<strong>请查看 message 字段定位启动异常原因</strong></p>
<hr>
<h2>Q ： 任务状态一直处于提交成功状态</h2>
<p>A： 1，首先通过<strong>jps 查看WorkerServer服务是否存在</strong>，或者从服务监控直接查看zk中是否存在worker服务</p>
<p>​       2，如果 <strong>WorkerServer</strong> 服务正常，需要 <strong>查看MasterServer是否把task任务放到zk队列中</strong> ，<strong>需要查看MasterServer日志及zk队列中是否有任务阻塞</strong></p>
<p>​	   3，如果以上都没有问题，需要定位是否指定了Worker分组，但是 <strong>Worker分组的机器不是在线状态</strong></p>
<hr>
<h2>Q ： <a href="http://install.sh">install.sh</a> 中需要注意问题</h2>
<p>A：  1，如果替换变量中包含特殊字符，<strong>请用 \ 转移符进行转移</strong></p>
<p>​	    2，installPath=&quot;/data1_1T/dolphinscheduler&quot;，<strong>这个目录不能和当前要一键安装的install.sh目录是一样的</strong></p>
<p>​	    3，deployUser=&quot;dolphinscheduler&quot;，<strong>部署用户必须具有sudo权限</strong>，因为worker是通过sudo -u 租户 sh xxx.command进行执行的</p>
<p>​	   4，monitorServerState=&quot;false&quot;，服务监控脚本是否启动，默认是不启动服务监控脚本的。<strong>如果启动服务监控脚本，则每5分钟定时来监控master和worker的服务是否down机，如果down机则会自动重启</strong></p>
<p>​		5，hdfsStartupSate=&quot;false&quot;，是否开启HDFS资源上传功能。默认是不开启的，<strong>如果不开启则资源中心是不能使用的</strong>。如果开启，需要conf/common/hadoop/hadoop.properties中配置fs.defaultFS和yarn的相关配置，如果使用namenode HA，需要将core-site.xml和hdfs-site.xml复制到conf根目录下</p>
<p>​	注意：<strong>1.0.x版本是不会自动创建hdfs根目录的，需要自行创建，并且需要部署用户有hdfs的操作权限</strong></p>
<hr>
<h2>Q ： 流程定义和流程实例下线异常</h2>
<p>A ： 对于 <strong>1.0.4 以前的版本中</strong>，修改dolphinscheduler-api cn.dolphinscheduler.api.quartz包下的代码即可</p>
<pre><code>public boolean deleteJob(String jobName, String jobGroupName) {
    lock.writeLock().lock();
    try {
      JobKey jobKey = new JobKey(jobName,jobGroupName);
      if(scheduler.checkExists(jobKey)){
        logger.info(&quot;try to delete job, job name: {}, job group name: {},&quot;, jobName, jobGroupName);
        return scheduler.deleteJob(jobKey);
      }else {
        return true;
      }

    } catch (SchedulerException e) {
      logger.error(String.format(&quot;delete job : %s failed&quot;,jobName), e);
    } finally {
      lock.writeLock().unlock();
    }
    return false;
  }
</code></pre>
<hr>
<h2>Q ： HDFS启动之前创建的租户，能正常使用资源中心吗</h2>
<p>A： 不能。因为在未启动HDFS创建的租户，不会在HDFS中注册租户目录。所以上次资源会报错</p>
<h2>Q :  多Master和多Worker状态下，服务掉了，怎么容错</h2>
<p>A：  <strong>注意：Master监控Master及Worker服务。</strong></p>
<p>​	1，如果Master服务掉了，其它的Master会接管挂掉的Master的流程，继续监控Worker task状态</p>
<p>​	2，如果Worker服务掉了，Master会监控到Worker服务掉了，如果存在Yarn任务，Kill Yarn任务之后走重试</p>
<p>具体请看容错设计：<a href="https://analysys.github.io/easyscheduler_docs_cn/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html#%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1">https://analysys.github.io/easyscheduler_docs_cn/系统架构设计.html#系统架构设计</a></p>
<hr>
<h2>Q ： 对于Master和Worker一台机器伪分布式下的容错</h2>
<p>A ： 1.0.3 版本只实现了Master启动流程容错，不走Worker容错。也就是说如果Worker挂掉的时候，没有Master存在。这流程将会出现问题。我们会在 <strong>1.1.0</strong> 版本中增加Master和Worker启动自容错，修复这个问题。如果想手动修改这个问题，需要针对 <strong>跨重启正在运行流程</strong> <strong>并且已经掉的正在运行的Worker任务，需要修改为失败</strong>，<strong>同时跨重启正在运行流程设置为失败状态</strong>。然后从失败节点进行流程恢复即可</p>
<hr>
<h2>Q ： 定时容易设置成每秒执行</h2>
<p>A ： 设置定时的时候需要注意，如果第一位（* * * * * ? *）设置成 * ，则表示每秒执行。<strong>我们将会在1.1.0版本中加入显示最近调度的时间列表</strong> ，使用http://cron.qqe2.com/ 可以在线看近5次运行时间</p>
<h2>Q： 定时有有效时间范围吗</h2>
<p>A：有的，<strong>如果定时的起止时间是同一个时间，那么此定时将是无效的定时</strong>。<strong>如果起止时间的结束时间比当前的时间小，很有可能定时会被自动删除</strong></p>
<h2>Q ： 任务依赖有几种实现</h2>
<p>A：  1，<strong>DAG</strong> 之间的任务依赖关系，是从 <strong>入度为零</strong> 进行DAG切分的</p>
<p>​	    2，有 <strong>任务依赖节点</strong> ，可以实现跨流程的任务或者流程依赖，具体请参考 依赖(DEPENDENT)节点：<a href="https://analysys.github.io/easyscheduler_docs_cn/%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C.html#%E4%BB%BB%E5%8A%A1%E8%8A%82%E7%82%B9%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE">https://analysys.github.io/easyscheduler_docs_cn/系统使用手册.html#任务节点类型和参数设置</a></p>
<p>​	注意：<strong>不支持跨项目的流程或任务依赖</strong></p>
<h2>Q： 流程定义有几种启动方式</h2>
<p>A： 1，在 <strong>流程定义列表</strong>，点击 <strong>启动</strong> 按钮</p>
<p>​		2，<strong>流程定义列表添加定时器</strong>，调度启动流程定义</p>
<p>​		3，流程定义 <strong>查看或编辑</strong> DAG 页面，任意 <strong>任务节点右击</strong> 启动流程定义</p>
<p>​		4，可以对流程定义 DAG 编辑，设置某些任务的运行标志位 <strong>禁止运行</strong>，则在启动流程定义的时候，将该节点的连线将从DAG中去掉</p>
<h2>Q ： Python任务设置Python版本</h2>
<p>A：  1，对于<strong>1.0.3之后的版本</strong>只需要修改 conf/env/.dolphinscheduler_env.sh中的PYTHON_HOME</p>
<pre><code>export PYTHON_HOME=/bin/python
</code></pre>
<p>注意：这了 <strong>PYTHON_HOME</strong> ，是python命令的绝对路径，而不是单纯的 PYTHON_HOME，还需要注意的是 export PATH 的时候，需要直接</p>
<pre><code>export PATH=$HADOOP_HOME/bin:$SPARK_HOME1/bin:$SPARK_HOME2/bin:$PYTHON_HOME:$JAVA_HOME/bin:$HIVE_HOME/bin:$PATH
</code></pre>
<p>​		2，对 1.0.3 之前的版本，Python任务只能支持系统的Python版本，不支持指定Python版本</p>
<h2>Q： Worker Task 通过sudo -u 租户 sh xxx.command会产生子进程，在kill的时候，是否会杀掉</h2>
<p>A： 我们会在1.0.4中增加kill任务同时，kill掉任务产生的各种所有子进程</p>
<h2>Q ： DolphinScheduler中的队列怎么用，用户队列和租户队列是什么意思</h2>
<p>A ： DolphinScheduler 中的队列可以在用户或者租户上指定队列，<strong>用户指定的队列优先级是高于租户队列的优先级的。</strong>，例如：对MR任务指定队列，是通过 mapreduce.job.queuename 来指定队列的。</p>
<p>注意：MR在用以上方法指定队列的时候，传递参数请使用如下方式：</p>
<pre><code>				Configuration conf = new Configuration();
        GenericOptionsParser optionParser = new GenericOptionsParser(conf, args);
        String[] remainingArgs = optionParser.getRemainingArgs();
</code></pre>
<p>如果是Spark任务 --queue 方式指定队列</p>
<h2>Q : Master 或者 Worker报如下告警</h2>
<p align="center">
   <img src="https://analysys.github.io/easyscheduler_docs_cn/images/master_worker_lack_res.png" width="60%" />
 </p>
<p>A ： 修改conf下的 master.properties <strong>master.reserved.memory</strong> 的值为更小的值，比如说0.1 或者</p>
<p>worker.properties <strong>worker.reserved.memory</strong> 的值为更小的值，比如说0.1</p>
<h2>Q : hive版本是1.1.0+cdh5.15.0，SQL hive任务连接报错</h2>
<p align="center">
   <img src="https://analysys.github.io/easyscheduler_docs_cn/images/cdh_hive_error.png" width="60%" />
 </p>
<p>A ： 将 hive pom</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.hive&lt;/groupId&gt;
    &lt;artifactId&gt;hive-jdbc&lt;/artifactId&gt;
    &lt;version&gt;2.1.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>修改为</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.hive&lt;/groupId&gt;
    &lt;artifactId&gt;hive-jdbc&lt;/artifactId&gt;
    &lt;version&gt;1.1.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
</div></section><footer class="footer-container"><div class="footer-body"><img src="/img/ds_gray.svg"/><div class="cols-container"><div class="col col-12"><h3>Disclaimer</h3><p>Apache DolphinScheduler (incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by Incubator. 
Incubation is required of all newly accepted projects until a further review indicates 
that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. 
While incubation status is not necessarily a reflection of the completeness or stability of the code, 
it does indicate that the project has yet to be fully endorsed by the ASF.</p></div><div class="col col-6"><dl><dt>文档</dt><dd><a href="/zh-cn/docs/development/architecture-design.html" target="_self">概览</a></dd><dd><a href="/zh-cn/docs/1.2.0/user_doc/quick-start.html" target="_self">快速开始</a></dd><dd><a href="/zh-cn/docs/1.2.0/user_doc/backend-development.html" target="_self">开发者指南</a></dd></dl></div><div class="col col-6"><dl><dt>ASF</dt><dd><a href="http://www.apache.org" target="_self">基金会</a></dd><dd><a href="http://www.apache.org/licenses/" target="_self">证书</a></dd><dd><a href="http://www.apache.org/events/current-event" target="_self">事件</a></dd><dd><a href="http://www.apache.org/foundation/sponsorship.html" target="_self">赞助</a></dd><dd><a href="http://www.apache.org/foundation/thanks.html" target="_self">致谢</a></dd></dl></div></div><div class="copyright"><span>Copyright © 2018-2020 The Apache Software Foundation. Apache DolphinScheduler, DolphinScheduler, and its feather logo are trademarks of The Apache Software Foundation.</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script>
		window.rootPath = '';
  </script>
	<script src="/build/documentation.js"></script>
</body>
</html>