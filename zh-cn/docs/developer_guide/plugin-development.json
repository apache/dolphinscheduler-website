{
  "filename": "plugin-development.md",
  "__html": "<h2>任务插件开发</h2>\n<p>提醒:目前任务插件开发暂不支持热部署</p>\n<h3>基于SHELL的任务</h3>\n<h4>基于YARN的计算（参见MapReduceTask）</h4>\n<ul>\n<li>需要在 <strong>cn.dolphinscheduler.server.worker.task</strong> 下的 <strong>TaskManager</strong> 类中创建自定义任务(也需在TaskType注册对应的任务类型)</li>\n<li>需要继承<strong>cn.dolphinscheduler.server.worker.task</strong> 下的 <strong>AbstractYarnTask</strong></li>\n<li>构造方法调度 <strong>AbstractYarnTask</strong> 构造方法</li>\n<li>继承 <strong>AbstractParameters</strong> 自定义任务参数实体</li>\n<li>重写 <strong>AbstractTask</strong> 的 <strong>init</strong> 方法中解析<strong>自定义任务参数</strong></li>\n<li>重写 <strong>buildCommand</strong> 封装command</li>\n</ul>\n<h4>基于非YARN的计算（参见ShellTask）</h4>\n<ul>\n<li>\n<p>需要在 <strong>cn.dolphinscheduler.server.worker.task</strong> 下的 <strong>TaskManager</strong> 中创建自定义任务</p>\n</li>\n<li>\n<p>需要继承<strong>cn.dolphinscheduler.server.worker.task</strong> 下的 <strong>AbstractTask</strong></p>\n</li>\n<li>\n<p>构造方法中实例化 <strong>ShellCommandExecutor</strong></p>\n<pre><code>public ShellTask(TaskProps props, Logger logger) {\n  super(props, logger);\n\n  this.taskDir = props.getTaskDir();\n\n  this.processTask = new ShellCommandExecutor(this::logHandle,\n      props.getTaskDir(), props.getTaskAppId(),\n      props.getTenantCode(), props.getEnvFile(), props.getTaskStartTime(),\n      props.getTaskTimeout(), logger);\n  this.processDao = DaoFactory.getDaoInstance(ProcessDao.class);\n}\n</code></pre>\n<p>传入自定义任务的 <strong>TaskProps</strong>和自定义<strong>Logger</strong>，TaskProps 封装了任务的信息，Logger分装了自定义日志信息</p>\n</li>\n<li>\n<p>继承 <strong>AbstractParameters</strong> 自定义任务参数实体</p>\n</li>\n<li>\n<p>重写 <strong>AbstractTask</strong> 的 <strong>init</strong> 方法中解析<strong>自定义任务参数实体</strong></p>\n</li>\n<li>\n<p>重写 <strong>handle</strong> 方法，调用 <strong>ShellCommandExecutor</strong> 的 <strong>run</strong> 方法，第一个参数传入自己的<strong>command</strong>，第二个参数传入 ProcessDao，设置相应的 <strong>exitStatusCode</strong></p>\n</li>\n</ul>\n<h3>基于非SHELL的任务（参见SqlTask）</h3>\n<ul>\n<li>需要在 <strong>cn.dolphinscheduler.server.worker.task</strong> 下的 <strong>TaskManager</strong> 中创建自定义任务</li>\n<li>需要继承<strong>cn.dolphinscheduler.server.worker.task</strong> 下的 <strong>AbstractTask</strong></li>\n<li>继承 <strong>AbstractParameters</strong> 自定义任务参数实体</li>\n<li>构造方法或者重写 <strong>AbstractTask</strong> 的 <strong>init</strong> 方法中，解析自定义任务参数实体</li>\n<li>重写 <strong>handle</strong> 方法实现业务逻辑并设置相应的<strong>exitStatusCode</strong></li>\n</ul>\n",
  "link": "/zh-cn/docs/developer_guide/plugin-development.html",
  "meta": {}
}