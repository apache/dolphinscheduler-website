# 参数优先级

DolphinScheduler 中所涉及的参数值定义通常来自以下类型：

- [全局参数](global.md)：在工作流保存页面定义时定义的变量
- [上游任务传递的参数](context.md)：上游任务传递过来的参数
- [本地参数](local.md)：节点的自有变量，用户在“自定义参数”定义的变量，并且用户可以在工作流定义时定义该部分变量的值

参数值存在多源，在参数名相同时，存在参数优先级的问题。DolphinScheduler 参数的优先级从高到低为：`全局参数 > 上游任务传递的参数 > 本地参数`

上游任务传递参数时可能存在多个任务向下游传递参数，存在上游传递的参数名称相同的问题：

- 下游节点会优先使用值为非空的参数
- 如果存在多个值为非空的参数，则按照上游任务的完成时间排序，选择完成时间最早的上游任务对应的参数

## 案例

如何使用任务参数传递的优先级问题：

1、以 shell 节点解释第一种情况

<img src="/img/globalParam/image-20210723102938239.png" alt="image-20210723102938239" style="zoom:50%;" />

节点 【useParam】可以使用到节点【createParam】中设置的变量。节点 【useParam】与节点【noUseParam】中并没有依赖关系，并不会获取到节点【noUseParam】的变量。（其他类型节点具有相同使用规则）

<img src="/img/globalParam/image-20210723103316896.png" alt="image-20210723103316896" style="zoom:50%;" />

节点【createParam】在使用变量时直接使用即可。该节点设置了 "key" 和 "key1" 两个变量。
用户定义了一个与上游节点传递变量名相同的变量 key1，并且复制其值为 "12"，由于设置优先级的关系，"12" 会被抛弃使用上游节点设置的变量值。

2、以 sql 节点来解释另外一种情况

<img src="/img/globalParam/image-20210723103937052.png" alt="image-20210723103937052" style="zoom:50%;" />

节点【use_create】的定义如下：

![image-20210723104411489](/img/globalParam/image-20210723104411489.png)

"status" 作为当前节点设置其节点的自有变量。用户保存时同样设置"status" 变量，且赋值为 -1。该 SQL 执行时，status 值为优先级更高的 -1。抛弃其节点自有变量的值。

"id" 是上游节点设置的变量，用户在节点【createParam1】、【createParam2】设置相同参数名 "id" 的参数。节点【use_create】使用其最先结束的【createParam1】的值。
